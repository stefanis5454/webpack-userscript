/**
 * UniversalReport
 * v3.5.3
 * @author jeffjnfeng 2022-07-14 11:37:56
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).UniversalReport=e()}(this,(function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function i(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n}function o(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}function r(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function s(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}function a(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i}function l(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var o,r,a=0|e,s=Math.max(a>=0?a:i-Math.abs(a),0);for(;s<i;){if((o=n[s])===(r=t)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;s++}return!1}}),Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,i=new Array(n);n--;)i[n]=[e[n],t[e[n]]];return i}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},writable:!0,configurable:!0});var u=setTimeout;function c(t){return Boolean(t&&void 0!==t.length)}function p(){}function d(t){if(!(this instanceof d))throw new TypeError("$Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],y(t,this)}function h(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,d._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void v(e.$Promise,t)}f(e.$Promise,i)}else(1===t._state?f:v)(e.$Promise,t._value)}))):t._deferreds.push(e)}function f(t,e){try{if(e===t)throw new TypeError("A $Promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof d)return t._state=3,t._value=e,void g(t);if("function"==typeof n)return void y((i=n,o=e,function(){i.apply(o,arguments)}),t)}t._state=1,t._value=e,g(t)}catch(e){v(t,e)}var i,o}function v(t,e){t._state=2,t._value=e,g(t)}function g(t){2===t._state&&0===t._deferreds.length&&d._immediateFn((function(){t._handled||d._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)h(t,t._deferreds[e]);t._deferreds=null}function m(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.$Promise=n}function y(t,e){var n=!1;try{t((function(t){n||(n=!0,f(e,t))}),(function(t){n||(n=!0,v(e,t))}))}catch(t){if(n)return;n=!0,v(e,t)}}d.prototype.catch=function(t){return this.then(null,t)},d.prototype.then=function(t,e){var n=new this.constructor(p);return h(this,new m(t,e,n)),n},d.prototype.finally=l,d.all=function(t){return new d((function(e,n){if(!c(t))return n(new TypeError("$Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var o=i.length;function r(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(e){r(t,e)}),n)}i[t]=a,0==--o&&e(i)}catch(t){n(t)}}for(var a=0;a<i.length;a++)r(a,i[a])}))},d.resolve=function(t){return t&&"object"==typeof t&&t.constructor===d?t:new d((function(e){e(t)}))},d.reject=function(t){return new d((function(e,n){n(t)}))},d.race=function(t){return new d((function(e,n){if(!c(t))return n(new TypeError("$Promise.race accepts an array"));for(var i=0,o=t.length;i<o;i++)d.resolve(t[i]).then(e,n)}))},d._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){u(t,0)},d._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console};var b=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"function"!=typeof b.Promise?b.Promise=d:b.Promise.prototype.finally||(b.Promise.prototype.finally=l);var w=Object.prototype.hasOwnProperty;function _(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}var P,E,I={stringify:function(t,e){e=e||"";var n,i,o=[];for(i in"string"!=typeof e&&(e="?"),t)if(w.call(t,i)){if((n=t[i])||null!=n&&!isNaN(n)||(n=""),i=encodeURIComponent(i),n=encodeURIComponent(n),null===i||null===n)continue;o.push(i+"="+n)}return o.length?e+o.join("&"):""},parse:function(t){for(var e,n=/([^=?&]+)=?([^&]*)/g,i={};e=n.exec(t);){var o=_(e[1]),r=_(e[2]);null===o||null===r||o in i||(i[o]=r)}return i}};(E=P||(P={}))[E.equal=0]="equal",E[E.low=-1]="low",E[E.high=1]="high";var S=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z-]+(?:\.[\da-z-]+)*)?(?:\+[\da-z-]+(?:\.[\da-z-]+)*)?)?)?$/i;function k(t){var e,n=t.replace(/^v/,"").replace(/\+.*$/,""),i=("-",-1===(e=n).indexOf("-")?e.length:e.indexOf("-")),o=n.substring(0,i).split(".");return o.push(n.substring(i+1)),o}function R(t){return isNaN(Number(t))?t:Number(t)}function T(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!S.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}var O=function(){function t(){this.eventsMap={}}return t.prototype.on=function(t,e){var n=this;t.split(",").forEach((function(t){n.eventsMap[t]||(n.eventsMap[t]=[]),n.eventsMap[t].push(e)}))},t.prototype.off=function(t,e){var n=this;t.split(",").forEach((function(t){n.removeListener(t,e)}))},t.prototype.emit=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=[];if(this.eventsMap[t]){var r=this.eventsMap[t].slice();r.forEach((function(i){try{o.push(i.apply(e,n))}catch(n){o.push(null),e.processError(n,t)}}))}return o},t.prototype.use=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],i=t.slice(1);return n.apply(void 0,s([this],i))},t.prototype.processError=function(t,e){},t.prototype.removeListener=function(t,e){if(this.eventsMap[t]){var n=this.eventsMap[t].findIndex((function(t){return t===e}));n>-1&&this.eventsMap[t].splice(n,1)}},t}(),C={qqvideo:{android:"8.3.40",ios:"8.3.60"}},x=0,A=1,N=2,D=3,M=["imei","imsi","idfa"],j="qq.com",L="undefined"!=typeof window&&window.IntersectionObserver&&window.IntersectionObserverEntry&&("isIntersecting"in window.IntersectionObserverEntry.prototype||"intersectionRatio"in window.IntersectionObserverEntry.prototype);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var q,B=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){t.exports=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)},e=function(){return e=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},e.apply(this,arguments)};function n(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function s(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}function i(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}var o="__BEACON_",r="__BEACON_deviceId",a="last_report_time",s="sending_event_ids",l="beacon_config",u="beacon_config_request_time",c=function(){function t(){var t=this;this.emit=function(e,n){if(t){var i,o=t.__EventsList[e];if(null==o?void 0:o.length){o=o.slice();for(var r=0;r<o.length;r++){i=o[r];try{var a=i.callback.apply(t,[n]);if(1===i.type&&t.remove(e,i.callback),!1===a)break}catch(t){throw t}}}return t}},this.__EventsList={}}return t.prototype.indexOf=function(t,e){for(var n=0;n<t.length;n++)if(t[n].callback===e)return n;return-1},t.prototype.on=function(t,e,n){if(void 0===n&&(n=0),this){var i=this.__EventsList[t];if(i||(i=this.__EventsList[t]=[]),-1===this.indexOf(i,e)){var o={name:t,type:n||0,callback:e};return i.push(o),this}return this}},t.prototype.one=function(t,e){this.on(t,e,1)},t.prototype.remove=function(t,e){if(this){var n=this.__EventsList[t];if(!n)return null;if(!e){try{delete this.__EventsList[t]}catch(t){}return null}if(n.length){var i=this.indexOf(n,e);n.splice(i,1)}return this}},t}();function p(t,e){for(var n={},i=0,o=Object.keys(t);i<o.length;i++){var r=o[i],a=t[r];if("string"==typeof a)n[d(r)]=d(a);else{if(e)throw new Error("value mast be string  !!!!");n[d(String(r))]=d(String(a))}}return n}function d(t){if("string"!=typeof t)return t;try{return t.replace(new RegExp("\\|","g"),"%7C").replace(new RegExp("\\&","g"),"%26").replace(new RegExp("\\=","g"),"%3D").replace(new RegExp("\\+","g"),"%2B")}catch(t){return""}}function h(t){return String(t.A99)+String(t.A100)}var f=function(){},v=function(){function t(t){var n=this;this.lifeCycle=new c,this.uploadJobQueue=[],this.additionalParams={},this.delayTime=0,this._normalLogPipeline=function(t){if(!t||!t.reduce||!t.length)throw new TypeError("createPipeline 鏂规硶闇€瑕佷紶鍏ヨ嚦灏戞湁涓€涓� pipe 鐨勬暟缁�");return 1===t.length?function(e,n){t[0](e,n||f)}:t.reduce((function(t,e){return function(n,i){return void 0===i&&(i=f),t(n,(function(t){return null==e?void 0:e(t,i)}))}}))}([function(t){n.send({url:n.strategy.getUploadUrl(),data:t,method:"post",contentType:"application/json;charset=UTF-8"},(function(){var e=n.config.onReportSuccess;"function"==typeof e&&e(JSON.stringify(t.events))}),(function(){var e=n.config.onReportFail;"function"==typeof e&&e(JSON.stringify(t.events))}))}]),function(t,e){if(!t)throw e instanceof Error?e:new Error(e)}(Boolean(t.appkey),"appkey must be initial"),this.config=e({},t)}return t.prototype.onUserAction=function(t,e){this.preReport(t,e,!1)},t.prototype.onDirectUserAction=function(t,e){this.preReport(t,e,!0)},t.prototype.preReport=function(t,e,n){t?this.strategy.isEventUpOnOff()&&(this.strategy.isBlackEvent(t)||this.strategy.isSampleEvent(t)||this.onReport(t,e,n)):this.errorReport.reportError("602"," no eventCode")},t.prototype.addAdditionalParams=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e];this.additionalParams[i]=t[i]}},t.prototype.setChannelId=function(t){this.commonInfo.channelID=String(t)},t.prototype.setOpenId=function(t){this.commonInfo.openid=String(t)},t.prototype.setUnionid=function(t){this.commonInfo.unid=String(t)},t.prototype.getDeviceId=function(){return this.commonInfo.deviceId},t.prototype.getCommonInfo=function(){return this.commonInfo},t.prototype.removeSendingId=function(t){try{var e=JSON.parse(this.storage.getItem(s)),n=e.indexOf(t);-1!=n&&(e.splice(n,1),this.storage.setItem(s,JSON.stringify(e)))}catch(t){}},t}(),g=function(){function t(t,e,n,i){this.requestParams={},this.network=i,this.requestParams.attaid="00400014144",this.requestParams.token="6478159937",this.requestParams.product_id=t.appkey,this.requestParams.platform=n,this.requestParams.uin=e.deviceId,this.requestParams.model="",this.requestParams.os=n,this.requestParams.app_version=t.appVersion,this.requestParams.sdk_version=e.sdkVersion,this.requestParams.error_stack="",this.uploadUrl=t.isOversea?"https://htrace.wetvinfo.com/kv":"https://h.trace.qq.com/kv"}return t.prototype.reportError=function(t,e){this.requestParams._dc=Math.random(),this.requestParams.error_msg=e,this.requestParams.error_code=t,this.network.get(this.uploadUrl,{params:this.requestParams}).catch((function(t){}))},t}(),m=function(){function t(t,e,n,i,o){this.strategy={isEventUpOnOff:!0,httpsUploadUrl:"https://otheve.beacon.qq.com/analytics/v2_upload",requestInterval:30,blacklist:[],samplelist:[]},this.realSample={},this.appkey="",this.needQueryConfig=!0,this.appkey=e.appkey,this.storage=i,this.needQueryConfig=t;try{var r=JSON.parse(this.storage.getItem(l));r&&this.processData(r)}catch(t){}e.isOversea&&(this.strategy.httpsUploadUrl="https://svibeacon.onezapp.com/analytics/v2_upload"),!e.isOversea&&this.needRequestConfig()&&this.requestConfig(e.appVersion,n,o)}return t.prototype.requestConfig=function(t,e,n){var i=this;this.storage.setItem(u,Date.now().toString()),n.post("https://oth.str.beacon.qq.com/trpc.beacon.configserver.BeaconConfigService/QueryConfig",{platformId:"undefined"==typeof wx?"3":"4",mainAppKey:this.appkey,appVersion:t,sdkVersion:e.sdkVersion,osVersion:e.userAgent,model:"",packageName:"",params:{A3:e.deviceId}}).then((function(t){if(0==t.data.ret)try{var e=JSON.parse(t.data.beaconConfig);e&&(i.processData(e),i.storage.setItem(l,t.data.beaconConfig))}catch(t){}else i.processData(null),i.storage.setItem(l,"")})).catch((function(t){}))},t.prototype.processData=function(t){var e,n,i,o,r;this.strategy.isEventUpOnOff=null!==(e=null==t?void 0:t.isEventUpOnOff)&&void 0!==e?e:this.strategy.isEventUpOnOff,this.strategy.httpsUploadUrl=null!==(n=null==t?void 0:t.httpsUploadUrl)&&void 0!==n?n:this.strategy.httpsUploadUrl,this.strategy.requestInterval=null!==(i=null==t?void 0:t.requestInterval)&&void 0!==i?i:this.strategy.requestInterval,this.strategy.blacklist=null!==(o=null==t?void 0:t.blacklist)&&void 0!==o?o:this.strategy.blacklist,this.strategy.samplelist=null!==(r=null==t?void 0:t.samplelist)&&void 0!==r?r:this.strategy.samplelist;for(var a=0,s=this.strategy.samplelist;a<s.length;a++){var l=s[a].split(",");2==l.length&&(this.realSample[l[0]]=l[1])}},t.prototype.needRequestConfig=function(){if(!this.needQueryConfig)return!1;var t=Number(this.storage.getItem(u));return Date.now()-t>60*this.strategy.requestInterval*1e3},t.prototype.getUploadUrl=function(){return this.strategy.httpsUploadUrl+"?appkey="+this.appkey},t.prototype.isBlackEvent=function(t){return-1!=this.strategy.blacklist.indexOf(t)},t.prototype.isEventUpOnOff=function(){return this.strategy.isEventUpOnOff},t.prototype.isSampleEvent=function(t){return!!Object.prototype.hasOwnProperty.call(this.realSample,t)&&this.realSample[t]<Math.floor(Math.random()*Math.floor(1e4))},t}(),y="session_storage_key",b=function(){function t(t,e,n){this.beacon=n,this.storage=t,this.duration=e,this.appkey=n.config.appkey}return t.prototype.getSession=function(){var t=this.storage.getItem(y);if(!t)return this.createSession();var e="",n=0;try{var i=JSON.parse(t)||{sessionId:void 0,sessionStart:void 0};if(!i.sessionId||!i.sessionStart)return this.createSession();var o=Number(this.storage.getItem(a));if(Date.now()-o>this.duration)return this.createSession();e=i.sessionId,n=i.sessionStart}catch(t){}return{sessionId:e,sessionStart:n}},t.prototype.createSession=function(){var t=Date.now(),e={sessionId:this.appkey+"_"+t.toString(),sessionStart:t};this.storage.setItem(y,JSON.stringify(e)),this.storage.setItem(a,t.toString());var n="is_new_user",i=this.storage.getItem(n);return this.beacon.onDirectUserAction("rqd_applaunched",{A21:i?"N":"Y"}),this.storage.setItem(n,JSON.stringify(!1)),e},t}();function w(){var t=navigator.userAgent,e=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1,n=t.indexOf("Edge")>-1&&!e,i=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1;if(e){new RegExp("MSIE (\\d+\\.\\d+);").test(t);var o=parseFloat(RegExp.$1);return 7==o?7:8==o?8:9==o?9:10==o?10:6}return n?-2:i?11:-1}function _(t,e){var n,i;return(n="https://tun-cos-1258344701.file.myqcloud.com/fp.js",void 0===i&&(i=Date.now()+"-"+Math.random()),new Promise((function(t,e){if(document.getElementById(i))t(void 0);else{var o=document.getElementsByTagName("head")[0],r=document.createElement("script");r.onload=function(){return function(){r.onload=null,t(void 0)}},r.onerror=function(t){r.onerror=null,o.removeChild(r),e(t)},r.src=n,r.id=i,o.appendChild(r)}}))).then((function(){(new Fingerprint).getQimei36(t,e)})).catch((function(t){})),""}var P,E=function(){return(E=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},I=function(){function t(t,e){void 0===e&&(e={}),this.reportOptions={},this.config=t,this.reportOptions=e}return t.canUseDB=function(){return!!(null===window||void 0===window?void 0:window.indexedDB)},t.prototype.openDB=function(){var e=this;return new Promise((function(n,i){if(!t.canUseDB())return i({message:"褰撳墠涓嶆敮鎸� indexeddb"});var o=e.config,r=o.name,a=o.version,s=o.stores,l=indexedDB.open(r,a);l.onsuccess=function(){e.db=l.result,n(),E({result:1,func:"open",params:JSON.stringify(e.config)},e.reportOptions)},l.onerror=function(t){var n,o;i(t),E({result:0,func:"open",params:JSON.stringify(e.config),error_msg:null===(o=null===(n=t.target)||void 0===n?void 0:n.error)||void 0===o?void 0:o.message},e.reportOptions)},l.onupgradeneeded=function(){e.db=l.result;try{null==s||s.forEach((function(t){e.createStore(t)}))}catch(t){E({result:0,func:"open",params:JSON.stringify(e.config),error_msg:t.message},e.reportOptions),i(t)}}}))},t.prototype.useStore=function(t){return this.storeName=t,this},t.prototype.deleteDB=function(){var t=this;return this.closeDB(),new Promise((function(e,n){var i=indexedDB.deleteDatabase(t.config.name);i.onsuccess=function(){return e()},i.onerror=n}))},t.prototype.closeDB=function(){var t;null===(t=this.db)||void 0===t||t.close(),this.db=null},t.prototype.getStoreCount=function(){var t=this;return new Promise((function(e,n){var i=t.getStore("readonly").count();i.onsuccess=function(){return e(i.result)},i.onerror=n}))},t.prototype.clearStore=function(){var t=this;return new Promise((function(e,n){var i=t.getStore("readwrite").clear();i.onsuccess=function(){return e()},i.onerror=n}))},t.prototype.add=function(t,e){var n=this;return new Promise((function(i,o){var r=n.getStore("readwrite").add(t,e);r.onsuccess=function(){i(r.result)},r.onerror=o}))},t.prototype.put=function(t,e){var n=this;return new Promise((function(i,o){var r=n.getStore("readwrite").put(t,e);r.onsuccess=function(){i(r.result)},r.onerror=o}))},t.prototype.getStoreAllData=function(){var t=this;return new Promise((function(e,n){var i=t.getStore("readonly").openCursor(),o=[];i.onsuccess=function(){var t;if(null===(t=i.result)||void 0===t?void 0:t.value){var n=i.result.value;o.push(n),i.result.continue()}else e(o)},i.onerror=n}))},t.prototype.getDataRangeByIndex=function(t,e,n,i,o){var r=this;return new Promise((function(a,s){var l=r.getStore().index(t),u=IDBKeyRange.bound(e,n,i,o),c=[],p=l.openCursor(u);p.onsuccess=function(){var t;(null===(t=null==p?void 0:p.result)||void 0===t?void 0:t.value)?(c.push(null==p?void 0:p.result.value),null==p||p.result.continue()):a(c)},p.onerror=s}))},t.prototype.removeDataByIndex=function(t,e,n,i,o){var r=this;return new Promise((function(a,s){var l=r.getStore("readwrite").index(t),u=IDBKeyRange.bound(e,n,i,o),c=l.openCursor(u),p=0;c.onsuccess=function(t){var e=t.target.result;e?(p+=1,e.delete(),e.continue()):a(p)},c.onerror=s}))},t.prototype.createStore=function(t){var e=t.name,n=t.indexes,i=void 0===n?[]:n,o=t.options;if(this.db){this.db.objectStoreNames.contains(e)&&this.db.deleteObjectStore(e);var r=this.db.createObjectStore(e,o);i.forEach((function(t){r.createIndex(t.indexName,t.keyPath,t.options)}))}},t.prototype.getStore=function(t){var e;return void 0===t&&(t="readonly"),null===(e=this.db)||void 0===e?void 0:e.transaction(this.storeName,t).objectStore(this.storeName)},t}(),S="event_table_v3",k="eventId",R=function(){function t(t){this.isReady=!1,this.taskQueue=Promise.resolve(),this.db=new I({name:"Beacon_"+t+"_V3",version:1,stores:[{name:S,options:{keyPath:k},indexes:[{indexName:k,keyPath:k,options:{unique:!0}}]}]}),this.open()}return t.prototype.getCount=function(){var t=this;return this.readyExec((function(){return t.db.getStoreCount()}))},t.prototype.setItem=function(t,e){var n=this;return this.readyExec((function(){return n.db.add({eventId:t,value:e})}))},t.prototype.getItem=function(t){return n(this,void 0,void 0,(function(){var e=this;return i(this,(function(n){return[2,this.readyExec((function(){return e.db.getDataRangeByIndex(k,t,t)}))]}))}))},t.prototype.removeItem=function(t){var e=this;return this.readyExec((function(){return e.db.removeDataByIndex(k,t,t)}))},t.prototype.updateItem=function(t,e){var n=this;return this.readyExec((function(){return n.db.put({eventId:t,value:e})}))},t.prototype.iterate=function(t){var e=this;return this.readyExec((function(){return e.db.getStoreAllData().then((function(e){e.forEach((function(e){t(e.value)}))}))}))},t.prototype.open=function(){return n(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return this.taskQueue=this.taskQueue.then((function(){return t.db.openDB()})),[4,this.taskQueue];case 1:return e.sent(),this.isReady=!0,this.db.useStore(S),[2]}}))}))},t.prototype.readyExec=function(t){return this.isReady?t():(this.taskQueue=this.taskQueue.then((function(){return t()})),this.taskQueue)},t}(),T=function(){function t(t){this.keyObject={},this.storage=t}return t.prototype.getCount=function(){return this.storage.getStoreCount()},t.prototype.removeItem=function(t){this.storage.removeItem(t),delete this.keyObject[t]},t.prototype.setItem=function(t,e){var n=JSON.stringify(e);this.storage.setItem(t,n),this.keyObject[t]=e},t.prototype.iterate=function(t){for(var e=Object.keys(this.keyObject),n=0;n<e.length;n++){var i=this.storage.getItem(e[n]);t(JSON.parse(i))}},t}(),O=function(){function t(t,e){var n=this;this.dbEventCount=0,w()>0||!window.indexedDB||/X5Lite/.test(navigator.userAgent)?(this.store=new T(e),this.dbEventCount=this.store.getCount()):(this.store=new R(t),this.getCount().then((function(t){n.dbEventCount=t})))}return t.prototype.getCount=function(){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.store.getCount()];case 1:return[2,t.sent()];case 2:return t.sent(),[2,Promise.reject()];case 3:return[2]}}))}))},t.prototype.insertEvent=function(t,e){return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:if(this.dbEventCount>=1e4)return[2,Promise.reject()];n=h(t.mapValue),i.label=1;case 1:return i.trys.push([1,3,,4]),this.dbEventCount++,[4,this.store.setItem(n,t)];case 2:return[2,i.sent()];case 3:return o=i.sent(),e&&e(o,t),this.dbEventCount--,[2,Promise.reject()];case 4:return[2]}}))}))},t.prototype.getEvents=function(){return n(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:t=[],e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.store.iterate((function(e){t.push(e)}))];case 2:case 3:return e.sent(),[2,Promise.all(t)];case 4:return[2]}}))}))},t.prototype.removeEvent=function(t){return n(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:e=h(t.mapValue),n.label=1;case 1:return n.trys.push([1,3,,4]),this.dbEventCount--,[4,this.store.removeItem(e)];case 2:return[2,n.sent()];case 3:return n.sent(),this.dbEventCount++,[2,Promise.reject()];case 4:return[2]}}))}))},t}(),C=function(){return(C=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function x(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function A(t,e){var n=[null,void 0,"",NaN].includes(t);if(e.isSkipEmpty&&n)return null;var i=!e.isSkipEmpty&&n?"":t;try{return e.encode?encodeURIComponent(i):i}catch(t){return null}}function N(t){var e=t.split("#"),n=e[0],i=e[1],o=void 0===i?"":i,r=n.split("?"),a=r[0],s=r[1],l=void 0===s?"":s,u=x(o),c=Object.create(null);return l.split("&").forEach((function(t){var e=t.split("="),n=e[0],i=e[1],o=void 0===i?"":i,r=x(n),a=x(o);null===r||null===a||""===r&&""===a||c[r]||(c[r]=a)})),{url:a,query:c,hash:u}}function D(t,e){void 0===e&&(e={encode:!0,isSkipEmpty:!1});var n=t.url,i=t.query,o=void 0===i?{}:i,r=t.hash,a=n.split("#"),s=a[0],l=a[1],u=void 0===l?"":l,c=s.split("?")[0],p=[],d=A(r||u,e),h=C(C({},N(n).query),o);return Object.keys(h).forEach((function(t){var n=A(t,e),i=A(h[t],e);null!==n&&null!==i&&p.push(n+"="+i)})),c+(p.length?"?"+p.join("&"):"")+(d?"#"+d:"")}function M(t,e){return new Promise((function(n,i){if(e&&document.querySelectorAll("script[data-tag="+e+"]").length)return n();var o=document.createElement("script"),r=C({type:"text/javascript",charset:"utf-8"},t);Object.keys(r).forEach((function(t){return function(t,e,n){if(t)return void 0===n?t.getAttribute(e):t.setAttribute(e,n)}(o,t,r[t])})),e&&(o.dataset.tag=e),o.onload=function(){return n()},o.onreadystatechange=function(){var t=o.readyState;["complete","loaded"].includes(t)&&(o.onreadystatechange=null,n())},o.onerror=i,document.body.appendChild(o)}))}!function(t){t[t.equal=0]="equal",t[t.low=-1]="low",t[t.high=1]="high"}(P||(P={}));var j=function(){return(j=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function L(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function s(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))}function q(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}var B=function(){function t(){this.interceptors=[]}return t.prototype.use=function(t,e){return this.interceptors.push({resolved:t,rejected:e}),this.interceptors.length-1},t.prototype.traverse=function(t,e){void 0===e&&(e=!1);var n=Promise.resolve(t);return(e?Array.prototype.reduceRight:Array.prototype.reduce).call(this.interceptors,(function(t,e){if(e){var i=e.resolved,o=e.rejected;n=n.then(i,o)}return t}),""),n},t.prototype.eject=function(t){this.interceptors[t]&&(this.interceptors[t]=null)},t}(),U={defaults:{timeout:0,method:"GET",mode:"cors",redirect:"follow",credentials:"same-origin"},headers:{common:{Accept:"application/json, text/plain, */*"},POST:{"Content-Type":"application/x-www-form-urlencoded"},PUT:{"Content-Type":"application/x-www-form-urlencoded"},PATCH:{"Content-Type":"application/x-www-form-urlencoded"}},baseURL:"",polyfillUrl:"https://vm.gtimg.cn/comps/script/fetch.min.js",interceptors:{request:new B,response:new B}},V=/^([a-z][a-z\d+\-.]*:)?\/\//i,H=Object.prototype.toString;function W(t){return L(this,void 0,void 0,(function(){var e;return q(this,(function(n){switch(n.label){case 0:if(window.fetch)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,M({src:t})];case 2:return n.sent(),[3,4];case 3:throw e=n.sent(),function(t){if("undefined"!=typeof Image){var e=new Image(1,1),n=j({attaid:"0f400053130",token:"6552374442",comps:"@tencent/ovb-request",version:"1.1.18",ua:navigator.userAgent,url:location.href,_dc:Math.random()},t),i=Object.keys(n).map((function(t){return t+"="+encodeURIComponent(n[t])})).join("&");e.src="https://h.trace.qq.com/kv?"+i}}({func:"loadPolyfill",result:0,params:t,error_msg:e.message}),new Error("鍔犺浇 polyfill "+t+" 澶辫触: "+e.message);case 4:return[2]}}))}))}function J(t){return["Accept","Content-Type"].forEach((function(e){return n=e,void((i=t.headers)&&Object.keys(i).forEach((function(t){t!==n&&t.toUpperCase()===n.toUpperCase()&&(i[n]=i[t],delete i[t])})));var n,i})),function(t){if("[object Object]"!==H.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}(t.body)&&(t.body=JSON.stringify(t.body),t.headers&&(t.headers["Content-Type"]="application/json;charset=utf-8")),t}function F(t){return L(this,void 0,void 0,(function(){var e,n,i,o,r,a,s,l,u,c,p,d,h,f,v,g,m;return q(this,(function(y){switch(y.label){case 0:return e=U.baseURL,n=U.defaults,i=U.interceptors,[4,W(U.polyfillUrl)];case 1:return y.sent(),(o=j(j({},n),t)).headers||(o.headers=function(t){void 0===t&&(t="GET");var e=U.headers[t]||{};return j(j({},U.headers.common),e)}(o.method)),J(o),[4,i.request.traverse(o,!0)];case 2:if((r=y.sent())instanceof Error)throw r;return r.url=function(t,e){return!t||V.test(e)?e:t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,"")}(e,r.url),a=r.url,s=r.timeout,l=r.params,u=r.method,c=["GET","DELETE","OPTIONS","HEAD"].includes(void 0===u?"GET":u)&&!!l,p=c?D({url:a,query:l}):a,d=[],s&&!r.signal&&(v=new Promise((function(t){h=setTimeout((function(){t(new Error("timeout"))}),s)})),d.push(v),f=new AbortController,r.signal=f.signal),d.push(fetch(p,r).catch((function(t){return t}))),[4,Promise.race(d)];case 3:return g=y.sent(),h&&clearTimeout(h),[4,i.response.traverse(g)];case 4:if((m=y.sent())instanceof Error)throw null==f||f.abort(),m;return[2,m]}}))}))}var z=function(){function t(t){U.interceptors.request.use((function(n){var i=n.url,o=n.method,r=n.body,a=r;if(t.onReportBeforeSend){var s=t.onReportBeforeSend({url:i,method:o,data:r?JSON.parse(r):null});a=(null==s?void 0:s.data)?JSON.stringify(s.data):null}return"GET"!=o&&a?e(e({},n),{body:a}):n}))}return t.prototype.get=function(t,o){return n(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return[4,F(e({url:t},o))];case 1:return[4,(n=i.sent()).json()];case 2:return r=i.sent(),[2,Promise.resolve({data:r,status:n.status,statusText:n.statusText,headers:n.headers})]}}))}))},t.prototype.post=function(t,o,r){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){switch(i.label){case 0:return[4,F(e({url:t,body:o,method:"POST"},r))];case 1:return[4,(n=i.sent()).json()];case 2:return a=i.sent(),[2,Promise.resolve({data:a,status:n.status,statusText:n.statusText,headers:n.headers})]}}))}))},t}(),G=function(){function t(t){this.appkey=t}return t.prototype.getItem=function(t){try{return window.localStorage.getItem(this.getStoreKey(t))}catch(t){return""}},t.prototype.removeItem=function(t){try{window.localStorage.removeItem(this.getStoreKey(t))}catch(t){}},t.prototype.setItem=function(t,e){try{window.localStorage.setItem(this.getStoreKey(t),e)}catch(t){}},t.prototype.setSessionItem=function(t,e){try{window.sessionStorage.setItem(this.getStoreKey(t),e)}catch(t){}},t.prototype.getSessionItem=function(t){try{return window.sessionStorage.getItem(this.getStoreKey(t))}catch(t){return""}},t.prototype.getStoreKey=function(t){return o+this.appkey+"_"+t},t.prototype.createDeviceId=function(){try{var t=window.localStorage.getItem(r);return t||(t=function(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",n="",i=0;i<t;i++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}(32),window.localStorage.setItem(r,t)),t}catch(t){return""}},t.prototype.clear=function(){try{for(var t=window.localStorage.length,e=0;e<t;e++){var n=window.localStorage.key(e);(null==n?void 0:n.substr(0,9))==o&&window.localStorage.removeItem(n)}}catch(t){}},t.prototype.getStoreCount=function(){var t=0;try{t=window.localStorage.length}catch(t){}return t},t}(),K="logid_start",Q="4.5.9-web";return function(n){function i(t){var e=n.call(this,t)||this;e.qimei36="",e.uselessCycleTaskNum=0,e.underWeakNet=!1,e.send=function(t,n,i){e.storage.setItem(a,Date.now().toString()),e.network.post(e.uploadUrl||e.strategy.getUploadUrl(),t.data).then((function(i){var o;100==(null===(o=null==i?void 0:i.data)||void 0===o?void 0:o.result)?e.delayTime=1e3*i.data.delayTime:e.delayTime=0,n&&n(t.data),t.data.events.forEach((function(t){e.store.removeEvent(t).then((function(){e.removeSendingId(h(t.mapValue))}))})),e.doCustomCycleTask()})).catch((function(n){var o=t.data.events;e.errorReport.reportError(n.code?n.code.toString():"600",n.message),i&&i(t.data);var r=JSON.parse(e.storage.getItem(s));o.forEach((function(t){r&&-1!=r.indexOf(h(t))&&e.store.insertEvent(t,(function(t,n){t&&e.errorReport.reportError("604","insertEvent fail!")})),e.removeSendingId(h(t))})),e.monitorUploadFailed()}))};var i,o,r=w();return e.isUnderIE8=r>0&&r<8,e.isUnderIE8||(e.isUnderIE=r>0,t.needInitQimei&&_(t.appkey,(function(t){e.qimei36=t.q36})),e.network=new z(t),e.storage=new G(t.appkey),e.initCommonInfo(t),e.store=new O(t.appkey,e.storage),e.errorReport=new g(e.config,e.commonInfo,"web",e.network),e.strategy=new m(null==t.needQueryConfig||t.needQueryConfig,e.config,e.commonInfo,e.storage,e.network),e.logidStartTime=e.storage.getItem(K),e.logidStartTime||(e.logidStartTime=Date.now().toString(),e.storage.setItem(K,e.logidStartTime)),i=e.logidStartTime,o=Date.now()-parseFloat(i),Math.floor(o/864e5)>=365&&e.storage.clear(),e.initSession(t),e.onDirectUserAction("rqd_js_init",{}),setTimeout((function(){return e.lifeCycle.emit("init")}),0),e.initDelayTime=t.delay?t.delay:1e3,e.cycleTask(e.initDelayTime)),e}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}(i,n),i.prototype.initSession=function(t){var e=18e5;t.sessionDuration&&t.sessionDuration>3e4&&(e=t.sessionDuration),this.beaconSession=new b(this.storage,e,this)},i.prototype.initCommonInfo=function(t){var e=Number(this.storage.getItem(a));try{var n=JSON.parse(this.storage.getItem(s));(Date.now()-e>3e4||!n)&&this.storage.setItem(s,JSON.stringify([]))}catch(t){}t.uploadUrl&&(this.uploadUrl=t.uploadUrl+"?appkey="+t.appkey);var i=[window.screen.width,window.screen.height];window.devicePixelRatio&&i.push(window.devicePixelRatio),this.commonInfo={deviceId:this.storage.createDeviceId(),language:navigator&&navigator.language||"zh_CN",query:window.location.search,userAgent:navigator.userAgent,pixel:i.join("*"),channelID:t.channelID?String(t.channelID):"",openid:t.openid?String(t.openid):"",unid:t.unionid?String(t.unionid):"",sdkVersion:Q},this.config.appVersion=t.versionCode?String(t.versionCode):"",this.config.strictMode=t.strictMode},i.prototype.cycleTask=function(t){var e=this;this.intervalID=window.setInterval((function(){e.store.getEvents().then((function(t){var n=[],i=JSON.parse(e.storage.getItem(s));i||(i=[]),t&&t.forEach((function(t){var e=h(t.mapValue);-1==i.indexOf(e)&&(n.push(t),i.push(e))})),0!=n.length&&(e.storage.setItem(s,JSON.stringify(i)),e._normalLogPipeline(e.assembleData(n)))})).catch((function(t){}))}),t)},i.prototype.onReport=function(t,e,n){var i=this;if(this.isUnderIE8)this.errorReport.reportError("601","UnderIE8");else{var o=this.generateData(t,e,n);if(n&&0==this.delayTime&&!this.underWeakNet)this._normalLogPipeline(this.assembleData(o));else{var r=o.shift();r&&this.store.insertEvent(r,(function(t){t&&i.errorReport.reportError("604","insertEvent fail!")})).catch((function(t){i._normalLogPipeline(i.assembleData(o))}))}}},i.prototype.onSendBeacon=function(t,e){if(this.isUnderIE)this.errorReport.reportError("605","UnderIE");else{var n=this.assembleData(this.generateData(t,e,!0));"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(this.uploadUrl||this.strategy.getUploadUrl(),JSON.stringify(n))}},i.prototype.generateData=function(t,n,i){var o=[],r="4.5.9-web_"+(i?"direct_log_id":"normal_log_id"),a=Number(this.storage.getItem(r));return a=a||1,n=e(e({},n),{A99:i?"Y":"N",A100:a.toString(),A72:Q,A88:this.logidStartTime}),a++,this.storage.setItem(r,a.toString()),o.push({eventCode:t,eventTime:Date.now().toString(),mapValue:p(n,this.config.strictMode)}),o},i.prototype.assembleData=function(t){var n=this.beaconSession.getSession();return{appVersion:this.config.appVersion?d(this.config.appVersion):"",sdkId:"js",sdkVersion:Q,mainAppKey:this.config.appkey,platformId:3,common:p(e(e({},this.additionalParams),{A2:this.commonInfo.deviceId,A8:this.commonInfo.openid,A12:this.commonInfo.language,A17:this.commonInfo.pixel,A23:this.commonInfo.channelID,A50:this.commonInfo.unid,A76:n.sessionId,A101:this.commonInfo.userAgent,A102:window.location.href,A104:document.referrer,A119:this.commonInfo.query,A153:this.qimei36}),!1),events:t}},i.prototype.monitorUploadFailed=function(){this.uselessCycleTaskNum++,this.uselessCycleTaskNum>=5&&(window.clearInterval(this.intervalID),this.cycleTask(6e4),this.underWeakNet=!0)},i.prototype.doCustomCycleTask=function(){this.uselessCycleTaskNum>=5&&(window.clearInterval(this.intervalID),this.cycleTask(this.initDelayTime)),this.uselessCycleTaskNum=0,this.underWeakNet=!1},i}(v)}()}));!function(t){t.PGIN="dt_pgin",t.PGOUT="dt_pgout",t.IMP="dt_imp",t.IMPEND="dt_imp_end",t.CLCK="dt_clck"}(q||(q={}));var U,V,H,W={dt_qq_h5:"",dt_qqopenid_h5:"",dt_wxopenid_h5:"",dt_wbopenid_h5:"",dt_mainlogin_h5:"",dt_qq:"",dt_qqopenid:"",dt_wxopenid:"",dt_wbopenid:"",dt_mainlogin:""};!function(t){t.ENABLE_FEATURE="1"}(U||(U={})),function(t){t.REPORT_VIEW="reportView",t.REALTIME_DEBUG="realTimeDebug",t.REPORT_VIEW_SET_TOKEN="setToken",t.REPORT_VIEW_PLUGIN_TOKEN="pluginToken",t.REALTIME_DEBUG_ID="dt_debugid",t.REALTIME_APP_ID="dt_appid"}(V||(V={})),function(t){t.OVERFLOWHIDE_ATTR="data-ofhide",t.ISSCROLLER_ATTR="data-scroller",t.LAZY_ATTR="data-lazy"}(H||(H={}));var J=function(t){var e=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},F=function(t,e){return Object.keys(t).filter((function(t){return!e.includes(t)})).map((function(e){var n;return e in t?((n={})[e]=t[e],n):{}})).reduce((function(t,e){return Object.assign(t,e)}),{})},z=function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},G=function(t){var e=t;return"string"==typeof e&&(e=document.querySelector(e)),z(e)?e:null},K=function(t){var e;if("string"==typeof t||"object"==typeof t&&(null===(e=t.baseInfo)||void 0===e?void 0:e.appkey)&&t.onUserAction&&t.onDirectUserAction)return!0},Q=function(t,e){var i,o;return void 0===e&&(e="udf_kv"),[q.PGIN,q.PGOUT].includes(t.eventName)?n(n({},t.publicParams),((i={})[e]=JSON.stringify(n({},t.pageParams)),i)):n(n({},t.publicParams),((o={})[e]=JSON.stringify(n({cur_pg:n({},t.pageParams)},t.businessParams)),o))},$=function(t,e,i){var o;void 0===e&&(e=1),void 0===i&&(i={});for(var r=i.eid?[i.eid]:[],a=i.eid?[i]:[],s=i,l=t;l;){var u=null===(o=l.data)||void 0===o?void 0:o.eid;u&&(e?s=n(n({eid:u},l.data.params),s):(r.push(u),a.push(n({eid:u},l.data.params)))),l=l.parent}return e?s:{element_path:r,element_params:a}},X=function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)?Object.entries(t).reduce((function(t,e){var n,i=e[0].substring(3);return Object.assign(t,((n={})[i]=e[1],n))}),{}):{}},Y=function(t,e){var n;return void 0===e&&(e=0),function(){for(var i=this,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];clearTimeout(n),n=setTimeout((function(){t.apply(i,o)}),e)}},Z=function(t){var e=[];if(null==t?void 0:t[0])for(var n=t.length-1;n>=0;n--){var i=t[n];1===i.nodeType&&e.unshift(i)}return e},tt=function(){function t(t){if(this.type="beacon",!K(t.beacon))throw new Error("\n        [universalReport] beacon must be a beacon application appkey or a beacon instance")}return t.prototype.init=function(t){var e=this;return new Promise((function(n,i){var o;"object"==typeof t.beacon?(e.beacon=t.beacon,n()):"string"==typeof t.beacon?(window.BeaconAction=null!==(o=window.BeaconAction)&&void 0!==o?o:B,n(e.initBeacon(t))):i(new Error("\n          [universalReport] beacon must be a beacon application appkey or a beacon instance"))}))},t.prototype.initBeacon=function(t){var e;try{this.beacon=new window.BeaconAction(n({appkey:t.beacon,versionCode:null!==(e=t.version)&&void 0!==e?e:"",delay:1e3,isDebug:t.debug,needQueryConfig:!1,onReportFail:function(t){}},t.beaconOptions))}catch(e){null==t||t.beaconFailCallback({err_message:e,result:1,fail_case:"beaconInitFail"})}},t.prototype.report=function(t){var e;if(t.eventName){var n=Q(t);t.isSendBeacon?null===(e=this.beacon)||void 0===e||e.onSendBeacon(t.eventName,n):~[q.PGIN,q.PGOUT].indexOf(t.eventName)&&this.beacon.onDirectUserAction?this.beacon.onDirectUserAction(t.eventName,n):this.beacon.onUserAction&&this.beacon.onUserAction(t.eventName,n)}},t}();function et(t){return new tt(t)}var nt=function(){function t(t){if(this.type="app",this.beaconReportPool=[],!K(t.beacon))throw new Error("\n        [universalReport] beacon must be a beacon application appkey or a beacon instance");this.appkey="string"==typeof t.beacon?t.beacon:t.beacon.baseInfo.appkey,this.options=t,this.enableBeaconReportRetry=t.enableBeaconReportRetry;try{this.topWindow=window.top,this.topWindow.dtResponseCallbacks={}}catch(t){this.topWindow=window,window.dtResponseCallbacks={}}}return t.prototype.init=function(){var t,e,n,i,o,s,l,u,c,p;return r(this,void 0,void 0,(function(){var r,d,h;return a(this,(function(a){switch(a.label){case 0:return[4,this.waitForDtJsReporterReady()];case 1:return a.sent(),"android"===this.hardwareOS&&(null===(e=null===(t=this.topWindow)||void 0===t?void 0:t.dtBridge)||void 0===e?void 0:e.postMessage)&&(this.nativeReportBridge=this.topWindow.dtBridge),"ios"===this.hardwareOS&&(null===(s=null===(o=null===(i=null===(n=this.topWindow)||void 0===n?void 0:n.webkit)||void 0===i?void 0:i.messageHandlers)||void 0===o?void 0:o.dtBridge)||void 0===s?void 0:s.postMessage)&&(this.nativeReportBridge=this.topWindow.webkit.messageHandlers.dtBridge),(null===(u=null===(l=this.topWindow)||void 0===l?void 0:l.DtJsReporter)||void 0===u?void 0:u.reportEvent)?"android"===this.hardwareOS?[3,3]:(r=this,[4,this.getJsApiCallbackAccess()]):this.nativeReportBridge?[2,Promise.resolve({reason:"native_fallback"})]:[2,Promise.reject({channel:"beacon",reason:"report_event_nil"})];case 2:return r.hasJsApiCallback=a.sent()||!1,this.initFallbackChannel(),[2,Promise.resolve({reason:"report_event_exist"})];case 3:return(null==(d=null===(p=null===(c=this.topWindow)||void 0===c?void 0:c.DtJsReporter)||void 0===p?void 0:p.isSupport)?void 0:d())?(h=this,[4,this.getJsApiCallbackAccess()]):[3,5];case 4:return h.hasJsApiCallback=a.sent()||!1,this.initFallbackChannel(),[2,Promise.resolve({reason:"report_event_exist"})];case 5:return[2,Promise.reject({channel:"beacon",reason:"andorid_not_support"})]}}))}))},t.prototype.initFallbackChannel=function(){this.initBeaconChannel(this.options),this.beaconChannelStatus="init"},t.prototype.getJsApiCallbackAccess=function(){var t=this;return new Promise((function(e){var n;setTimeout((function(){e(!1)}),500),null===(n=t.topWindow.DtJsReporter)||void 0===n||n.getSdkVersion({onCallback:function(t){var n=t.data;e((null==n?void 0:n.sdkVersion)>2100)}})})).catch((function(t){}))},t.prototype.initBeaconChannel=function(t){var e=this;return this.beaconChannel=et(t),Promise.resolve(this.beaconChannel.init(t)).then((function(){e.beaconChannelStatus="ready";for(var t=null;t=e.beaconReportPool.shift();)e.beaconChannel.report(t)})).catch((function(t){}))},t.prototype.waitForDtJsReporterReady=function(){var t=this;return new Promise((function(e){var n,i;if(null===(i=null===(n=t.topWindow)||void 0===n?void 0:n.DtJsReporter)||void 0===i?void 0:i.reportEvent)e();else{var o=setTimeout((function(){e()}),1e3),r=function(){t.topWindow.document.removeEventListener("onDtJsReporterReady",r),clearTimeout(o),e()};t.topWindow.document.addEventListener("onDtJsReporterReady",r)}}))},t.prototype.report=function(t){var e,n,i=this;if(t.isSendBeacon&&"ready"===this.beaconChannelStatus)this.beaconChannel.report(t);else{var o=null===(n=null===(e=this.topWindow)||void 0===e?void 0:e.DtJsReporter)||void 0===n?void 0:n.reportEvent;if(o){var r,a=Q(t);this.hasJsApiCallback&&(r=setTimeout((function(){r=null,i.callbackTimeoutHandler(t,N)}),1e3)),o({params:a,eventId:t.eventName,appKey:this.appkey,onCallback:this.nativeCallback(t,r,N)})}else this.nativeReportBridge&&this.nativeReport(t)}},t.prototype.nativeReport=function(t){var e=this;if(this.nativeReportBridge){var n,i=""+Date.now()+Math.random().toString().slice(2,5),o=Q(t);n=setTimeout((function(){n=null,e.callbackTimeoutHandler(t,D),delete e.topWindow.dtResponseCallbacks[i]}),1e3);this.topWindow.dtResponseCallbacks[i]=function(o){n&&(e.nativeCallback(t,n,D)(o),delete e.topWindow.dtResponseCallbacks[i])};var r=JSON.stringify({handlerName:"vr_reportEvent",callbackId:i,data:{params:o,eventId:t.eventName,appKey:this.appkey}});this.nativeReportBridge.postMessage(r)}},t.prototype.beaconReport=function(t){this.enableBeaconReportRetry&&("ready"!==this.beaconChannelStatus?this.beaconReportPool.push(t):this.beaconChannel.report(t))},t.prototype.callbackTimeoutHandler=function(t,e){var n,i;this.fallbackReport(t,e),null===(n=this.options)||void 0===n||n.jsApiReportCallback({code:"504",msg:"timeout",step:e,event_type:t.eventName,event_id:null===(i=null==t?void 0:t.publicParams)||void 0===i?void 0:i.dt_eventid_h5})},t.prototype.fallbackReport=function(t,e){e===N&&this.nativeReportBridge?this.nativeReport(t):this.beaconReport(t)},t.prototype.nativeCallback=function(t,e,n){var i=this;return function(o){var r,a,s;e&&clearTimeout(e);var l={ret:"",msg:""};try{l="string"==typeof o?JSON.parse(o):o}catch(t){l={ret:"500",msg:"callback result parse error"}}var u=l.ret,c=l.msg;"200"!==u&&i.fallbackReport(t,n),null===(r=i.options)||void 0===r||r.jsApiReportCallback({code:u,msg:c,step:n,event_type:t.eventName,pgid:null==t?void 0:t.pgid,eid:null===(a=null==t?void 0:t.businessParams)||void 0===a?void 0:a.eid,event_id:null===(s=null==t?void 0:t.publicParams)||void 0===s?void 0:s.dt_eventid_h5})}},t}();var it=function(t,e,n,i,o){var r="";if("string"===typeof n)r="; expires="+n;else if(n instanceof Date)r="; expires="+n.toUTCString();else{r="; expires="+new Date(Date.now()+6048e5).toUTCString()}var a=i||location.hostname,s=o||"/";document.cookie=[t,"=",escape(e),r,";domain=",a,";path=",s].join("")},ot=function(t){for(var e={},n=document.cookie.split(";"),i=0,o=n.length;i<o;i++){var r=n[i].replace(/^\s+/,"").split("="),a=r[0],s=r[1];e[a]=s}return t?e[t]:e};function rt(t,e){var n=new XMLHttpRequest;n.open("POST",t,!0),n.timeout=1e4,n.setRequestHeader("content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4===n.readyState&&200!==n.status&&n.status},n.ontimeout=function(){n.abort()},n.send(e)}var at=function(){function t(t){if(this.options=t,this.type="boss",!t.bossSet)throw new Error("[universalReport] please specify the bossSet");this.bossSet=t.bossSet}return t.prototype.init=function(){if(!ot("txv_boss_uuid")){it("txv_boss_uuid",(t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)})()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),new Date(Date.now()+31536e6))}var t},t.prototype.report=function(t){var e=this.bossSet[t.eventName];if(e&&(this.isBeehive(e)||this.isAtta(e))){var n=this.formatBossData(e,t);rt(n.url,n.data)}},t.prototype.formatBossData=function(e,i){var o=[],r=Math.random().toString(36).substr(2,8),a="";this.isBeehive(e)?a=t.bossUrl+"?BossId="+e.BossId+"&Pwd="+e.Pwd+"&_dc="+r:this.isAtta(e)&&(a=t.attaUrl+"?attaid="+e.AttaId+"&token="+e.token+"&_dc="+r);var s=n(n(n({},e),Q(i,"kv")),{dc:r});return Object.keys(s).forEach((function(t){o.push(t+"="+encodeURIComponent(s[t]))})),{url:a,data:o.join("&")}},t.prototype.isBeehive=function(t){return void 0!==t.BossId&&void 0!==t.Pwd},t.prototype.isAtta=function(t){return void 0!==t.AttaId&&void 0!==t.token},t.bossUrl="https://btrace.qq.com/kvcollect",t.attaUrl="https://h.trace.qq.com/kv",t}();var st={app:function(t){return new nt(t)},beacon:et,boss:function(t){return new at(t)}},lt=Object.keys(st);var ut=function(){},ct=function(t){function o(e,n,i,o){void 0===n&&(n=""),void 0===i&&(i=""),void 0===o&&(o="");var r=t.call(this)||this;return r.options=e,r.scenePlat=n,r.sceneVersion=i,r.hardwareOS=o,r.channelReady=!1,r.pool=[],r.loadChannel(e),r}return e(o,t),o.prototype.loadChannel=function(t){this.setChannel(t),this.initChannel(t)},o.prototype.setChannel=function(t){var e=t.channel,n=void 0===e?"app":e;if("qqvideo"===this.scenePlat&&"app"===n&&this.isLowerThanRequiredVersion()&&(n="beacon"),~lt.indexOf(n))this.curChannel=st[n](t);else if("function"==typeof n)this.curChannel=n(t);else{if("object"!=typeof n)throw new Error("[universalReport] channel must be "+lt.map((function(t){return'"'+t+'"'})).join(", ")+", a function or a object");this.curChannel=n}if("app"===n&&(this.curChannel.hardwareOS=this.hardwareOS),!this.curChannel.report)throw new Error("[universalReport] no report function found in channel")},o.prototype.isLowerThanRequiredVersion=function(){var t,e=null===(t=C[this.scenePlat])||void 0===t?void 0:t[this.hardwareOS];return!!e&&function(t,e){[t,e].forEach(T);for(var n=k(t),i=k(e),o=0;o<Math.max(n.length-1,i.length-1);o++){var r=parseInt(n[o]||"0",10),a=parseInt(i[o]||"0",10);if(r>a)return P.high;if(a>r)return P.low}var s=n[n.length-1],l=i[i.length-1];if(s&&l){var u=s.split(".").map(R),c=l.split(".").map(R);for(o=0;o<Math.max(u.length,c.length);o++){if(void 0===u[o]||"string"==typeof c[o]&&"number"==typeof u[o])return-1;if(void 0===c[o]||"string"==typeof u[o]&&"number"==typeof c[o])return 1;if(u[o]>c[o])return P.high;if(c[o]>u[o])return P.low}}else if(s||l)return s?P.low:P.high;return P.equal}(this.sceneVersion,e)<0},o.prototype.initChannel=function(t){var e,i=this,o=t.channel;Object.assign(t,{beaconFailCallback:function(t){var e=t.fail_case;i.emit(e,t)},jsApiReportCallback:function(t){i.emit("jsApiReport",t)}}),this.curChannel.init=null!==(e=this.curChannel.init)&&void 0!==e?e:ut,Promise.resolve(this.curChannel.init(t)).then((function(t){var e;i.emit("initChannel",{report_type:o,result:0,deviceId:(null===(e=i.curChannel.beacon)||void 0===e?void 0:e.getDeviceId())||""}),"app"===i.curChannel.type&&i.emit("jsApiReport",n({step:x,result:"success"},null!=t?t:{})),i.channelReady=!0;for(var r=null;r=i.pool.shift();)r.call(i)})).catch((function(t){var e,o=t,r=o.channel,a=o.reason;if("app"===i.curChannel.type&&i.emit("jsApiReport",{step:x,result:"fail",reason:a}),!("string"==typeof(e=r)&&~lt.indexOf(e)||"function"==typeof e||"object"==typeof e&&"report"in e))throw t;i.loadChannel(n(n({},i.options),{channel:r}))})).catch((function(t){i.emit("initChannel",{report_type:o,result:1,err_message:t})}))},o.prototype.report=function(t){var e=this,o=t.uid,r=i(t,["uid"]),a=n({uid:o},r),s=function(){var t,n,i;e.curChannel.report(r),e.emit("report",a),r.monitoringReport&&e.emit("monitoringReport",{device_id:null===(t=e.curChannel.beacon)||void 0===t?void 0:t.getDeviceId(),report_type:e.curChannel.type,event_type:(null==r?void 0:r.eventName)||"",publicParams:null==r?void 0:r.publicParams}),r.monitoringJsApiReport&&e.emit("jsApiReport",{pgid:null==r?void 0:r.pgid,eid:null===(n=null==r?void 0:r.businessParams)||void 0===n?void 0:n.eid,step:A,event_type:null==r?void 0:r.eventName,report_type:e.curChannel.type,event_id:null===(i=null==r?void 0:r.publicParams)||void 0===i?void 0:i.dt_eventid_h5})};this.channelReady?s():this.pool.push(s)},o}(O),pt={attaUrl:"https://h.trace.qq.com/kv",attaId:"0b300050665",token:"6554817333"},dt={attaUrl:"https://h.trace.qq.com/kv",attaId:"01600053974",token:"9671122527"};function ht(t,e){void 0===e&&(e=pt);try{var i=function(t,e){var i,o=[],r=Math.random().toString(36).substr(2,8);i=e.attaUrl+"?attaid="+e.attaId+"&token="+e.token+"&_dc="+r;var a=encodeURIComponent((""+window.location.host+window.location.pathname).replace(/\./g,"_")),s=n(n({Attaid:e.attaId,token:e.token,url:encodeURIComponent(window.location.href),path:a},t),{dc:r});return Object.keys(s).forEach((function(t){o.push(t+"="+encodeURIComponent(s[t]))})),{url:i,data:o.join("&")}}(t,e);rt(i.url,i.data)}catch(t){throw new Error("[universalReport] atta report fail")}}var ft=function(){function t(t){this.context=t,this.events={}}return t.prototype.on=function(t,e){var n=this.events[t]||[];return n.push(e),this.events[t]=n,this},t.prototype.off=function(t,e){if(void 0===e)this.events[t]=[];else for(var n=this.events[t]||[],i=n.length-1;i>=0;i--)if(n[i]===e){n[i]=null;break}return this},t.prototype.emit=function(t,e,n){var i="click"===t,o=this.events[t]||[];"boolean"==typeof n&&(i=n);for(var r=o.length-1;r>=0;r--){var a=o[r];if("function"==typeof a)if(i)setTimeout((function(t,e,n){null==t||t.call(e,n)}),0,a,this.context,e);else try{a.call(this.context,e)}catch(t){}}return this},t.prototype.clear=function(){this.events={}},t.prototype.listeners=function(t){return this.events[t]||[]},t}(),vt=function(t,e,n){var i=e(t,n),o=t.childNodes;if("boolean"==typeof i)return i;for(var r=0,a=o.length;r<a;r++){var s=o[r];if(s&&1===s.nodeType)if(vt(s,e,i))return!0}},gt=function(t,e){var n=e(t),i=t.childNodes;if("boolean"==typeof n)return n;for(var o=i.length-1;o>=0;o--){var r=i[o];if(r&&1===r.nodeType)if(gt(r,e))return!0}},mt=function(t,e){for(var n=t;n;){var i=e(n);if(n=n.parentNode,"boolean"==typeof i&&i)break}},yt=function(t,e){for(var n=[t];n.length>0;){var i=n.shift(),o=e(i);if(!0===o)return o;!1!==o&&(i.children.length>0&&(n=i.children.concat(n)))}},bt=function(){function t(t,e,n){this.data=n||{},this.parent=null,this.children=[],this.uid="",this.emitter=new ft(this),this.unbinds={},this.width=0,this.height=0,this.effectiveWidth=0,this.effectiveHeight=0,this.top=0,this.left=0,this.scrollTop=0,this.scrollLeft=0,this.maxScrollTop=0,this.maxScrollLeft=0,this.maxIntersectArea=0,this.tree=t,this.el=e,this.lazy=!0,this.delegates={},this.visible=!1,this.pt=0,this.pl=0,this.overflowHide=!0,this.isScroller=!1,this.scrolling=!1,this.rect={top:0,left:0,right:0,bottom:0},this.viewport={top:0,left:0,right:0,bottom:0},this.lazy=!1,this.lastHash="",this.domNativeEvents={click:!0,scroll:!0},this.fastTriggeredEvents={click:!0},this.attach(e)}return t.getWindowNode=function(){if(t.windowNode)return t.windowNode;var e=new t;return e.scrollLeft=window.scrollX,e.scrollTop=window.scrollY,e.top=0,e.left=0,e.width=window.innerWidth,e.height=window.innerHeight,e.isScroller=!0,e.viewport={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight},e.rect={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight},e.getScrollParent=function(){return null},e.attachScroller=function(t,n){var i=t||window,o=n.throttle,r=function(){var t=i.scrollX-e.scrollLeft,n=i.scrollY-e.scrollTop;e.scrollLeft=i.scrollX,e.scrollTop=i.scrollY,e.moveTree(t,n,!0),e.scrolling=!1,e.emitter.emit("scrollend")};if(o>0){var a=Y(r,o);r=function(){e.scrolling=!0,a()}}i.addEventListener("scroll",r)},window.addEventListener("resize",(function(){e.width=window.innerWidth,e.height=window.innerHeight,e.viewport={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight},e.rect={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight},e.emit("resize")})),t.windowNode=e,e},t.getNode=function(e){return t.store[e.__doid]},t.prototype.updateData=function(e,n,i){var o=this,r=e.attributes,a=function(t){var n=r[t.name];if(n)return t.func.call(o,n.value,e)},s=t.globalNodeConfig,l=!1;if(this.stopBubbleFlag=s.stopBubbleFlag,void 0===n)Object.keys(s.map).forEach((function(t){return a(s.map[t])}));else{var u=s.map[n];u&&(l=a(u))}s.events.forEach((function(t){var a=t.name;o.off(a,t.action),t.condition.call(o,r,e)&&o.on(a,t.action);var s=t.keyAttrs;s instanceof Array&&n&&l&&s.indexOf(n)>-1&&(!i||i!==o.lastHash)&&(o.lastHash=i,"expose"===a?o.visible&&o.emit(a):o.emit(a))})),void 0===n?(this.updateOfData(r),this.updateScrollData(r,e),this.updateLazyData(r)):n===H.OVERFLOWHIDE_ATTR?this.updateOfData(r):n===H.ISSCROLLER_ATTR?this.updateScrollData(r,e):n===H.LAZY_ATTR&&this.updateLazyData(r)},t.prototype.updateOfData=function(t){var e=t[H.OVERFLOWHIDE_ATTR];this.overflowHide=!(e&&"false"===e.value)},t.prototype.updateScrollData=function(t,e){t[H.ISSCROLLER_ATTR]?this.attachScroller(e):this.off("scroll")},t.prototype.updateLazyData=function(t){var e=t[H.LAZY_ATTR];this.lazy=!(!e||"true"!==e.value)},t.prototype.on=function(t,e){var n=this,i="expose"===t&&this.emitter.listeners("expose").length<=0;return this.elOn(t,e),i&&this.elOn("visibilityChanged",(function(t){t?n.emit("expose"):n.emit("hide")})),this},t.prototype.attach=function(e){var n=!1,i=e;if(this.detach(!0),i){var o=i.__doid;n=!o,this.el=i,n&&(o=t.sessionId+"_"+t.autoId,t.autoId+=1,this.uid=o,i.__doid=o,t.store[o]=this),this.updateData(i)}return n},t.prototype.detach=function(e){void 0===e&&(e=!1);var n=this.el,i=this.unbinds;if(this.unbinds={},n){var o=n.__doid;o&&(this.data.keepReport&&t.removedStore.set(n,t.store[o]),t.store[o]=null,n.__doid=null)}e&&this.emitter.clear(),Object.keys(i).forEach((function(t){try{i[t]()}catch(t){}}))},t.prototype.attachScroller=function(t,e){var n=this;if(!L){var i=function(){var e=t.scrollLeft-n.scrollLeft,i=t.scrollTop-n.scrollTop;n.scrollTop=t.scrollTop,n.scrollLeft=t.scrollLeft,n.maxScrollTop=Math.max(n.maxScrollTop,n.scrollTop),n.maxScrollLeft=Math.max(n.maxScrollLeft,n.scrollLeft),n.moveTree(e,i,!0),n.scrolling=!1,n.emitter.emit("scrollend")},o=null==e?void 0:e.throttle;if(o>0){var r=Y(i,o);i=function(){n.scrolling=!0,r()}}this.scrollTop=t.scrollTop,this.scrollLeft=t.scrollLeft,this.isScroller=!0,this.elOn("scroll",i)}},t.prototype.getScrollParent=function(){for(var e=this.parent;e&&!e.isScroller;)e=e.parent;return e||t.getWindowNode()},t.prototype.getScrollingParent=function(){for(var t=this.getScrollParent();t&&!t.scrolling;)t=t.getScrollParent();return(null==t?void 0:t.scrolling)?t:void 0},t.prototype.getRect=function(){return this.rect},t.prototype.recalc=function(){var t=this;if(!L){var e=this.el;if(e){var n=this.getScrollParent(),i=this.getScrollingParent();if(i)return this.scrollEndHandle&&i.emitter.off("scrollend",this.scrollEndHandle),this.scrollEndHandle=function(){t.recalc(),i.emitter.off("scrollend",t.scrollEndHandle),t.scrollEndHandle=null},void i.emitter.on("scrollend",this.scrollEndHandle);var o=e.getBoundingClientRect(),r=n.getRect(),a=o.top-r.top+n.scrollTop;this.top=a;var s=o.left-r.left+n.scrollLeft;this.left=s,this.width=o.width,this.height=o.height,this.isScroller?(this.scrollTop=this.el.scrollTop,this.scrollLeft=this.el.scrollLeft,this.pt=n.pt+a-this.scrollTop,this.pl=n.pl+s-this.scrollLeft,this.effectiveWidth=e.scrollWidth||this.effectiveWidth,this.effectiveHeight=e.scrollHeight||this.effectiveHeight):(this.effectiveWidth=o.width||this.effectiveWidth,this.effectiveHeight=o.height||this.effectiveHeight);var l=this.rect.top!==o.top||this.rect.left!==o.left||this.rect.right!==o.right||this.rect.bottom!==o.bottom;return this.rect.top=o.top,this.rect.left=o.left,this.rect.right=o.right,this.rect.bottom=o.bottom,this.calcViewPort(),this.syncVisible(),l}}},t.prototype.move=function(t,e){this.isScroller&&(this.pt=this.pt-e,this.pl=this.pl-t);var n=this.rect;n.top=n.top-e,n.left=n.left-t,n.right=n.right-t,n.bottom=n.bottom-e,this.calcViewPort(),this.syncVisible()},t.prototype.calcViewPort=function(){if(!L){var e=this.rect,n=this.parent||t.getWindowNode(),i=this.viewport,o=n.viewport;this.overflowHide?(i.top=Math.max(e.top,o.top),i.left=Math.max(e.left,o.left),i.right=Math.min(e.right,o.right),i.bottom=Math.min(e.bottom,o.bottom)):(i.top=o.top,i.left=o.left,i.right=o.right,i.bottom=o.bottom)}},t.prototype.calcExposeArea=function(){var t=this.rect,e=this.viewport,n=Math.max(t.left,e.left),i=Math.min(t.right,e.right),o=Math.max(e.bottom-t.top,0);return Math.max(o*(i-n),0)},t.prototype.updateNode=function(){this.maxScrollTop=this.scrollTop,this.maxScrollLeft=this.scrollLeft,this.effectiveWidth=this.width,this.effectiveHeight=this.height,this.maxIntersectArea=this.calcExposeArea()},t.prototype.syncVisible=function(){if(!L){var t=this.calcVisible();return t!==this.visible?(this.visible=t,t&&this.updateNode(),this.emitter.emit("visibilityChanged",t),!0):void 0}},t.prototype.moveTree=function(e,n,i){var o,r=this;if(this.el&&!i&&(mt(this.el,(function(e){if(r.el!==e&&t.getNode(e))return!0;if(1!==e.nodeType)return!0;var n=getComputedStyle(e);return("fixed"===n.position||"sticky"===n.position)&&(o=e,!0)})),o))return;i||this.move(e,n);for(var a=this.children.length-1;a>=0;a--)this.children[a].moveTree(e,n)},t.prototype.calcVisible=function(){var e=this.rect,n=(this.parent||t.getWindowNode()).viewport,i=Math.max(this.calcExposeArea(),this.maxIntersectArea||0);return this.maxIntersectArea=Math.max(i,0),!(e.left>=n.right||e.right<=n.left||e.top>=n.bottom||e.bottom<=n.top)},t.prototype.destroy=function(){this.remove(),this.detach()},t.prototype.elOn=function(e,n){var i=this,o=this.emitter;if(o.on(e,n),this.domNativeEvents[e]){var r=this.unbinds,a=this.el;if(!r[e]){if(this.fastTriggeredEvents[e]){var s=this.tree.root;if(s&&!s.delegates[e]&&s.el){var l=function(n){var i=n,o=i.target,r=t.getNode(o)||t.removedStore.get(o);!r||r.lazy||i["_vn_id_"+r.uid]||(r.emitter.emit(e,i,r.lazy),i["_vn_id_"+r.uid]=!0)};s.delegates[e]=l,s.el.addEventListener(e,l)}}var u=function(t){var n=t;if(!n["_vn_id_"+i.uid]){if(i.stopBubbleFlag){if(n.reported)return;n.reported=!0}o.emit(e,n,i.lazy),n["_vn_id_"+i.uid]=!0}};a.addEventListener(e,u),r[e]=function(){a.removeEventListener(e,u)}}}else if(L&&"visibilityChanged"===e){if(!(r=this.unbinds)[e]){var c=this.el;t.iobserver.observe(c),r[e]=function(){t.iobserver.unobserve(c)}}}return this},t.prototype.off=function(t,e){return this.emitter.off(t,e),this},t.prototype.emit=function(t,e){return this.emitter.emit(t,e),this},t.prototype.setData=function(t){Object.assign(this.data,t)},t.prototype.mapParent=function(t){var e=[];if(this.parent)for(var n=this.parent;n;){var i=n;if("function"==typeof t&&(i=t(n)),"boolean"==typeof i&&i)break;e.push(i),n=n.parent}return e},t.prototype.index=function(){var t=this.parent;return t?t.children.indexOf(this):0},t.prototype.append=function(t){var e=t;e&&(e.remove(),e.parent=this,this.children.push(e))},t.prototype.insert=function(t,e){var n=this;e&&(e.forEach((function(t){var e=t;e.remove(),e.parent=n})),Array.prototype.splice.apply(this.children,s([t,0],e)))},t.prototype.remove=function(){var t=this.parent;this.parent=null,t&&(t.children=t.children.filter((function(e){return e.parent===t})))},t.prototype.clear=function(){if(this.children.length>0){var t=this.children;this.children=[];for(var e=0,n=t.length;e<n;e++){t[e].parent=null}}},t.store={},t.removedStore=new WeakMap,t.autoId=1,t.sessionId=Math.random().toString(36).substring(2),t.windowNode=null,t}(),wt=function(){function t(){var t;this.root=null,this.rootDom=null,this.genHash=(t=0,function(){return t+=1,""+(new Date).getTime()+t})}return t.attachDom=function(e){if(void 0===e&&(e=document.body),!z(e))throw new Error('parameter 1 is not of type "Node"');var n=t.getVtreeMap().get(e)||null;return n||(n=new this,t.getVtreeMap().set(e,n),n.attach(e),bt.getWindowNode().on("resize",(function(){n.reflow(n.root)})),bt.getWindowNode().attachScroller(window,{throttle:200}),bt.getWindowNode().append(n.root),n)},t.detachDom=function(e){if(!z(e))throw new Error('parameter 1 is not of type "Node"');var n=t.getVtreeMap().get(e)||null;n&&(n.observer.disconnect(),n.detach())},t.getVtreeMap=function(){return t.vTreeMap},t.shouldBeNode=function(e){var n=e.attributes,i=t.treeConfigs,o=i.overFlowAttr,r=i.isScrollerAttr,a=i.lazyAttr;return!!t.getVtreeMap().get(e)||(!!(n[o]||n[r]||n[a])||t.attrs.some((function(t){return n[t]})))},t.prototype.attach=function(e){var n=this;if(!t.shouldBeNode(e))throw new Error("root should be a node");this.rootDom=e,this.root=bt.getNode(e)||new bt(this,e),this.update({el:e}),this.reflow({el:e}),this.observer=new MutationObserver((function(t){try{var e=n.mut(t),i=e.updateArr,o=e.reflowArr;i&&i.length>0&&n.update(i),o&&o.length>0&&n.reflow(o)}catch(t){}})),this.observer.observe(e,{characterData:!0,attributes:!0,childList:!0,subtree:!0})},t.prototype.detach=function(){t.getVtreeMap().delete(this.rootDom),this.remove({all:[this.root.el]})},t.prototype.update=function(t){var e=this,n=this.genHash();(t instanceof Array?t:[t]).forEach((function(t){e[t.action||"add"](t,n)}))},t.prototype.createTree=function(e){var n=this,i=[];return vt(e,(function(e,o){if(t.shouldBeNode(e)){var r=bt.getNode(e);return r?r.clear():r=new bt(n,e),o?o.append(r):i.push(r),r}return o})),i},t.prototype.add=function(t){for(var e=t.el,n=[],i=t.all||[t.el],o=0,r=i.length;o<r;o++){var a=i[o];n=n.concat(this.createTree(a))}if(0!==n.length){var s=null,l=null;mt(e,(function(t){if(e!==t&&(s=bt.getNode(t)))return!0;for(var n=t.previousElementSibling;n&&(gt(n,(function(t){if(l=bt.getNode(t))return!0})),!l);)n=n.previousElementSibling;return!!l})),!l&&s?s.insert(0,n):l&&(s=s||l.parent)&&s.insert(s.children.indexOf(l)+1,n)}},t.prototype.remove=function(t){for(var e=t.all||[t.el],n=0,i=e.length;n<i;n++){var o=e[n];vt(o,(function(t){var e=bt.getNode(t);e&&e.destroy()}))}},t.prototype.reflow=function(t){var e=this;if(!L){var n=null,i=this.genHash(),o=1===(n=t instanceof Array?t:[t]).length&&bt.getNode(n[0]);if(!o){var r={},a=0,s=""+Math.floor(1e4*Math.random());n.forEach((function(t){var e=null==t?void 0:t.el;if(e){var n=s+(a+=1);e.__tmpid=n,r[n]=t}}));for(var l=[this.root.el];l.length>0;){var u=l.shift();if(o=bt.getNode(u)||o,r[u.__tmpid]&&o)break;(null==u?void 0:u.children)&&u.children.length>0&&(l=[].slice.call(u.children).concat(l))}}o&&(!function(t,e,n,i){for(var o=[],r=t,a=n;r&&(o.push(r),r!==i);)r=r.parent;for(var s=o.length-1;s>=0&&("boolean"!=typeof(a=e(o[s],a))||!a);s--);}(o,(function(t){var n=t;if(n.el&&n.el.__rechash!==i&&(n.el.__rechash=i,n.recalc(),e.root!==n))for(var o=n.parent?n.parent.children:[],r=o.indexOf(n),a=o.length;r<a;){var s=o[r];if(yt(s,(function(t){var e=t;e.el.__rechash!==i&&(e.el.__rechash=i,e.recalc())})))break;r+=1}}),!1,this.root),yt(o,(function(t){var e=t;o!==e&&e.el.__rechash!==i&&(e.el.__rechash=i,e.recalc())})))}},t.prototype.getSiblingReportNode=function(t){for(var e=t,n=null;e&&!(n=bt.getNode(e));)e=e.nextElementSibling;return n},t.prototype.mut=function(e){for(var n=[],i=[],o=this.genHash(),r=0,a=e;r<a.length;r++){var s=a[r],l=s.target;if("childList"===s.type){var u=Z(s.addedNodes),c=Z(s.removedNodes),p=s.previousSibling;if(u[0]&&n.push({el:u[0],action:"add",all:u}),c[0]&&n.push({el:c[0],action:"remove",all:c}),p&&1!==p.nodeType&&(p=p.previousElementSibling),p){var d=p.nextElementSibling;d?i.push({el:d}):l&&i.push({el:l,ignoreChild:!0})}else l&&i.push({el:l})}else if("attributes"===s.type){if(!l)return;var h=s.attributeName;l.__atmrhash===o||"class"!==h&&"style"!==h||(l.__atmrhash=o,i.push({el:l}));var f=bt.getNode(l),v=t.shouldBeNode(l);f&&!v||!f&&v&&(l.__atmuhash!==o&&(l.__atmuhash=o,n.push({el:l,action:"add",all:[l]})),l.__atmrhash!==o&&(l.__atmrhash=o,i.push({el:l}))),f&&f.updateData(l,h,o)}else{if(!l)return;1!==l.nodeType&&(l=l.parentNode),i.push({el:l})}}return{updateArr:n,reflowArr:i}},t.attrs=[],t.vTreeMap=new WeakMap,t}(),_t=function(t,e,n){void 0===e&&(e="expose"),t&&t.length&&t.forEach((function(t){t&&(t.visible&&(n?n(t):t.emit(e)),_t(t.children,e,n))}))},Pt=function(t){return{top:Math.round(t.top),bottom:Math.round(t.bottom),left:Math.round(t.left),right:Math.round(t.right)}};var Et=function(t){var e,n=null==t?void 0:t.el;return null===(e=null==n?void 0:n.hasAttribute)||void 0===e?void 0:e.call(n,"dt-pgid")},It=function(t,e){var n,i;if(t){for(var o=null,r=t;!o&&r;)if(o=null===(n=r.data)||void 0===n?void 0:n[e],r=r.parent,!o&&Et(r)){o=null===(i=r.data)||void 0===i?void 0:i[e];break}return o}},St=function(){function t(t){this.reportNode=bt,this.reportTree=wt,this.initIntersectionObserver(),this.addConfig(t)}return t.prototype.getReportNode=function(t){return t?this.reportNode.getNode(t):null},t.prototype.getClosestParentNode=function(t){for(var e=t,n=null;!n&&e&&e.hasAttribute&&!e.hasAttribute("dt-pgid");)e=e.parentNode,n=this.getReportNode(e);return n},t.prototype.addConfig=function(t){var e,n,i,o=t.attrs,r=t.events,a=this.getAttrConfig(o),s=this.getEventConfig(r);this.reportTree.attrs=Object.keys(o),this.reportTree.treeConfigs={overFlowAttr:null!==(e=t.overflowHide)&&void 0!==e?e:H.OVERFLOWHIDE_ATTR,isScrollerAttr:null!==(n=t.isScroller)&&void 0!==n?n:H.ISSCROLLER_ATTR,lazyAttr:null!==(i=t.lazy)&&void 0!==i?i:H.LAZY_ATTR},this.reportNode.globalNodeConfig={map:a,events:s,stopBubbleFlag:t.stopBubbleFlag}},t.prototype.initIntersectionObserver=function(){L&&(this.reportNode.iobserver=new IntersectionObserver((function(t){try{t.forEach((function(t){var e=t.target,n=bt.getNode(e);if(n){n.rect={top:t.boundingClientRect.top,bottom:t.boundingClientRect.bottom,left:t.boundingClientRect.left,right:t.boundingClientRect.right};var i=void 0!==t.isIntersecting?t.isIntersecting:t.intersectionRatio>0;n.visible!==i&&(n.visible=i,n.width=t.boundingClientRect.width,n.height=t.boundingClientRect.height,n.emit("visibilityChanged",i)),n.recalc()}}))}catch(t){}})))},t.prototype.getAttrConfig=function(t){var e=Object.keys(t),n={};return t&&e.forEach((function(e){var i,o=t[e];"string"==typeof o?i=function(t){var e=this.data[o]!==t;return this.data[o]=t,e}:"object"==typeof o&&(i=function(t){var n,i=o.prop||e,r=o.dataType;if("JSON"===r)try{n=JSON.parse(t)}catch(t){}else n="KV"===r?function(t){var e={};if("string"==typeof t)for(var n=t.split("&"),i=0,o=n.length;i<o;i++){var r=n[i],a=/^([^=]+)=(.*)$/.exec(r);if(a)try{e[a[1]]=decodeURIComponent(a[2])}catch(t){}}return e}(t):t;return this.data[i]=n||{},!0});var r={name:e,func:i};n[e]=r})),n},t.prototype.getEventConfig=function(t){if(t)return Object.keys(t).map((function(e){var n=t[e],i={name:e,action:n.action,condition:null,keyAttrs:null},o=n.condition;return i.condition=function(t){return o.some((function(e){return t[e]}))},"click"!==e&&(i.keyAttrs=o),n.keyAttrs&&(i.keyAttrs=n.keyAttrs),i}))},t}();function kt(t,e){var i;!function(t){var e=t.observer,n=t.isEnablePlugin;if(e){var i=function(t){s?t():a.push(t)},o=e.reportNode.prototype,r=o.updateData;if(o.updateData=function(e,o,a){var s,l,u=this,c=r.call(this,e,o,a),p=this.data.pgid||"",d=null===(l=null===(s=this.data)||void 0===s?void 0:s.cmd)||void 0===l?void 0:l.hold;return"dt-pgid"===o&&this.oldPgid&&p!==this.oldPgid?t.emit("pageIdChange",e,this.oldPgid):"dt-params"===o&&p?t.emit("pageParamsChange",e,p):"dt-cmd"===o&&"false"===d&&d!==this.oldHold&&_t([this],"expose",null),this.oldPgid=p,this.oldHold=d||"false",n&&i((function(){var e=u.emitter,n=e.events.click,i=e.events.expose;t.emit("mutation",{action:"updateData",node:u,data:{data:u.data,exp:i?1:void 0,cli:n?1:void 0,of:u.overflowHide?void 0:1}})})),c},n){var a=[],s=!1;t.on("viewPluginReady",(function(){s=!0;for(var t=null;t=a.shift();)t()}));var l=o.append;o.append=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=l.apply(this,n);return i((function(){t.emit("mutation",{action:"append",node:e})})),r};var u=o.insert;o.insert=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=u.apply(this,n),a=n[1]||[];return i((function(){t.emit("mutation",{action:"insert",node:e,data:a})})),r};var c=o.calcViewPort;o.calcViewPort=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=c.apply(this,n);return i((function(){t.emit("mutation",{action:"calcViewPort",node:e,data:{viewport:Pt(e.viewport)}})})),r};var p=o.recalc;o.recalc=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=p.apply(this,n);return i((function(){t.emit("mutation",{action:"recalc",node:e,data:{viewport:Pt(e.viewport)}})})),r};var d=o.move;o.move=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=d.apply(this,n);return i((function(){t.emit("mutation",{action:"move",node:e,data:{viewport:Pt(e.viewport),rect:Pt(e.rect)}})})),r};var h=o.remove;o.remove=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return i((function(){t.emit("mutation",{action:"remove",node:e})})),h.apply(this,n)};var f=o.clear;o.clear=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return i((function(){t.emit("mutation",{action:"clear",node:e})})),f.apply(this,n)}}}}(t);var o={click:{condition:["dt-eid"],action:function(){var e=It(this,"pgid")||t.pageManager.fixPgid(),i=this.data.eid,o=It(this,"cmd")||{},r="true"===this.data.clckIgnore,a="true"===this.data.sendBeacon,s=t.pageManager.hasPage(e);e&&i&&"true"!==o.hold&&!r&&s&&t.reportElement(this.el,{pgid:e,eventName:q.CLCK,eventTime:Date.now(),businessParams:n({eid:i},this.data.params),isSendBeacon:a})}},expose:{condition:["dt-pgid","dt-eid"],action:function(){var e=It(this,"pgid"),i=It(this,"cmd")||{};if(e&&"true"!==i.hold)if(Et(this)){var o="true"===this.data.pgIgnore,r="true"===this.data.pginIgnore;if(o||r)return;var a=t.firstPVReportMap[e];if(t.setFirstPVFlag(e,"reported"),"first_reported"===a)return;t.reportPV(e)}else{var s=this.data.eid,l="true"===this.data.impIgnore||"true"===this.data.impStartIgnore,u="true"===this.data.impOnce,c=t.pageManager.hasPage(e);if(!s||l||u&&this.data.impReported||!c)return;this.data.impReported=!0,t.reportElement(this.el,{pgid:e,eventName:q.IMP,eventTime:Date.now(),businessParams:n({eid:s},this.data.params)})}}},hide:{condition:["dt-pgid","dt-eid"],action:function(){var e=It(this,"pgid"),i=It(this,"cmd")||{};if(e&&"true"!==i.hold)if(Et(this)){var o="true"===this.data.pgIgnore,r="true"===this.data.pgoutIgnore;if(o||r)return;t.reportPgOut(e)}else{var a=this.data.eid,s="true"===this.data.impIgnore||"true"===this.data.impEndIgnore,l="true"===this.data.impOnce,u=t.pageManager.hasPage(e);if(!a||s||l&&this.data.impEndReported||!u)return;this.data.impEndReported=!0;var c=this.effectiveWidth*this.effectiveHeight,p=this.isScroller?(this.maxScrollLeft+this.width)*(this.maxScrollTop+this.height):this.maxIntersectArea,d=c?Math.min(p/c,1):0,h=this.el.showTime,f={dt_element_area:c.toFixed(2),dt_ele_imp_area:p.toFixed(2),dt_element_lvtm:h?Date.now()-this.el.showTime:0,dt_ele_imp_rate:d.toFixed(2)};t.reportElement(this.el,{pgid:e,eventName:q.IMPEND,eventTime:Date.now(),publicParams:n({},f),businessParams:n(n({eid:a},X(f)),this.data.params)})}}}},r=new St({isScroller:"dt-scroll",overflowHide:"dt-overflow-hide",lazy:"dt-lazy",stopBubbleFlag:e,attrs:(i={},i["dt-pgid"]="pgid",i["dt-eid"]="eid",i["dt-params"]={prop:"params",dataType:"KV"},i["dt-cmd"]={prop:"cmd",dataType:"KV"},i["dt-pg-ignore"]="pgIgnore",i["dt-pgin-ignore"]="pginIgnore",i["dt-pgout-ignore"]="pgoutIgnore",i["dt-imp-ignore"]="impIgnore",i["dt-imp-end-ignore"]="impEndIgnore",i["dt-imp-start-ignore"]="impStartIgnore",i["dt-clck-ignore"]="clckIgnore",i["dt-send-beacon"]="sendBeacon",i["dt-imp-once"]="impOnce",i["dt-keep-report"]="keepReport",i),events:o});Object.assign(t,{eventsConfig:o,observer:r})}var Rt,Tt,Ot,Ct,xt,At,Nt=function(){function t(){this.pageMap={}}return t.prototype.hasPage=function(t){return t&&!!this.pageMap[t]},t.prototype.addPage=function(t){var e,i=null===(e=null==t?void 0:t.pageParams)||void 0===e?void 0:e.pgid,o=G(null==t?void 0:t.pageRoot);if(i&&o){var r=I.parse(J("ref_pg")||""),a=I.parse(J("ref_ele")||"");this.pageMap[i]=n(n({},t),{pageParams:n({ref_pg:r.pgid?r:{},ref_ele:a.eid?a:{}},t.pageParams),pageRoot:o})}else;},t.prototype.getPage=function(t){return this.hasPage(t)?this.pageMap[t]:null},t.prototype.setPage=function(t){var e,i=null===(e=null==t?void 0:t.pageParams)||void 0===e?void 0:e.pgid,o=this.pageMap[i];this.hasPage(i)&&(this.pageMap[i]=n(n(n({},o),t),{pageParams:n(n({},o.pageParams),t.pageParams)}))},t.prototype.removePage=function(t){this.hasPage(t)&&delete this.pageMap[t]},t.prototype.updatePage=function(t){var e,n;if(this.hasPage(t)){var i=Number(null!==(n=null===(e=this.getPage(t).pageParams)||void 0===e?void 0:e.pg_stp)&&void 0!==n?n:0)+1;this.setPage({pageParams:{pgid:t,pg_stp:i},showTime:Date.now(),clckFlag:"0"})}},t.prototype.fixPgid=function(t){if(t)return t;var e=Object.keys(this.pageMap);return 1===e.length?e[0]:""},t}(),Dt="function",Mt="object",jt="model",Lt="name",qt="type",Bt="vendor",Ut="version",Vt="console",Ht="phone",Wt="tablet",Jt="tv",Ft=function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},zt={rgx:function(t,e){for(var n,i,o,r,a,s,l=0;l<e.length&&!a;){var u=e[l],c=e[l+1];for(n=i=0;n<u.length&&!a;)if(a=u[n++].exec(t))for(o=0;o<c.length;o++)s=a[++i],typeof(r=c[o])===Mt&&r.length>0?2==r.length?typeof r[1]==Dt?this[r[0]]=r[1].call(this,s):this[r[0]]=r[1]:3==r.length?typeof r[1]!==Dt||r[1].exec&&r[1].test?this[r[0]]=s?s.replace(r[1],r[2]):void 0:this[r[0]]=s?r[1].call(this,s,r[2]):void 0:4==r.length&&(this[r[0]]=s?r[3].call(this,s.replace(r[1],r[2])):void 0):this[r]=s||void 0;l+=2}},str:function(t,e){for(var n in e)if(typeof e[n]===Mt&&e[n].length>0){for(var i=0;i<e[n].length;i++)if(Ft(e[n][i],t))return"?"===n?void 0:n}else if(Ft(e[n],t))return"?"===n?void 0:n;return t}},Gt={os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},Kt={device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[jt,Bt,[qt,Wt]],[/applecoremedia\/[\w\.]+ \((ipad)/],[jt,[Bt,"Apple"],[qt,Wt]],[/(apple\s{0,1}tv)/i],[[jt,"Apple TV"],[Bt,"Apple"],[qt,Jt]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[Bt,jt,[qt,Wt]],[/(kf[A-z]+)(\sbuild\/|\)).+silk\//i],[jt,[Bt,"Amazon"],[qt,Wt]],[/android.+aft([bms])\sbuild/i],[jt,[Bt,"Amazon"],[qt,Jt]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[jt,Bt,[qt,Ht]],[/\((ip[honed|\s\w*]+);/i],[jt,[Bt,"Apple"],[qt,Ht]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[Bt,jt,[qt,Ht]],[/\(bb10;\s(\w+)/i],[jt,[Bt,"BlackBerry"],[qt,Ht]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[jt,[Bt,"Asus"],[qt,Wt]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[Bt,"Sony"],[jt,"Xperia Tablet"],[qt,Wt]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[jt,[Bt,"Sony"],[qt,Ht]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[Bt,jt,[qt,Vt]],[/android.+;\s(shield)\sbuild/i],[jt,[Bt,"Nvidia"],[qt,Vt]],[/(playstation\s[34portablevi]+)/i],[jt,[Bt,"Sony"],[qt,Vt]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[Bt,[jt,/_/g," "],[qt,Ht]],[/(nexus\s9)/i],[jt,[Bt,"HTC"],[qt,Wt]],[/d\/huawei([\w\s-]+)[;\)]/i,/android.+\s(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?)/i],[jt,[Bt,"Huawei"],[qt,Ht]],[/android.+(bah2?-a?[lw]\d{2})/i],[jt,[Bt,"Huawei"],[qt,Wt]],[/(microsoft);\s(lumia[\s\w]+)/i],[Bt,jt,[qt,Ht]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[jt,[Bt,"Microsoft"],[qt,Vt]],[/(kin\.[onetw]{3})/i],[[jt,/\./g," "],[Bt,"Microsoft"],[qt,Ht]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[jt,[Bt,"Motorola"],[qt,Wt]],[/hbbtv.+maple;(\d+)/i],[[jt,/^/,"SmartTV"],[Bt,"Samsung"],[qt,Jt]],[/\(dtv[\);].+(aquos)/i],[jt,[Bt,"Sharp"],[qt,Jt]],[/android.+((sch-i[89]0\d|shw-m380s|SM-P605|SM-P610|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[Bt,"Samsung"],jt,[qt,Wt]],[/smart-tv.+(samsung)/i],[Bt,[qt,Jt],jt],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[Bt,"Samsung"],jt,[qt,Ht]],[/sie-(\w*)/i],[jt,[Bt,"Siemens"],[qt,Ht]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[Bt,"Nokia"],jt,[qt,Ht]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[jt,[Bt,"Acer"],[qt,Wt]],[/android.+([vl]k\-?\d{3})\s+build/i],[jt,[Bt,"LG"],[qt,Wt]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[Bt,"LG"],jt,[qt,Wt]],[/linux;\snetcast.+smarttv/i,/lg\snetcast\.tv-201\d/i],[[Bt,"LG"],jt,[qt,Jt]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[jt,[Bt,"LG"],[qt,Ht]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[Bt,jt,[qt,Wt]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[jt,[Bt,"Lenovo"],[qt,Wt]],[/(lenovo)[_\s-]?([\w-]+)/i],[Bt,jt,[qt,Ht]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[Bt,jt,[qt,Ht]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[jt,[Bt,"Vivo"],[qt,Ht]],[/(HM\sNOTE)/i,/(HM\s\w+)/i,/(MI\s\w+)/i,/(MI-ONE\sPlus)/i,/(M1)\sBuild/i,/(HM\d+)/i,/Xiaomi[\s_]?([\w_]+)/i],[[jt,/_/g," "],[Bt,"Xiaomi"],[qt,Ht]],[/android.+(mi[\s\-_]?(?:pad)(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i],[[jt,/_/g," "],[Bt,"Xiaomi"],[qt,Wt]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[jt,[Bt,"Meizu"],[qt,Ht]],[/(mz)-([\w-]{2,})/i],[[Bt,"Meizu"],jt,[qt,Ht]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[jt,[Bt,"OnePlus"],[qt,Ht]],[/android .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[jt,[qt,Ht]],[/android .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[jt,[qt,Wt]],[/\s(mobile)(?:[;\/]|\ssafari)/i],[[qt,Ht],Bt,jt],[/\s(tablet|tab)[;\/]/i],[[qt,Wt],Bt,jt],[/[\s\/\(](smart-?tv)[;\)]/i],[[qt,Jt]],[/(android[\w\.\s\-]{0,9});.+build/i],[jt,[Bt,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[Ut,[Lt,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[Ut,[Lt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[Lt,Ut],[/rv\:([\w\.]{1,9}).+(gecko)/i],[Ut,Lt]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[Lt,Ut],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[Lt,[Ut,zt.str,Gt.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[Lt,"windows"],[Ut,zt.str,Gt.os.windows.version]],[/(android)[\/\s-]?([\w\.]*)/i],[Lt,Ut],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[Ut,/_/g,"."],[Lt,"ios"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[Lt,"macos"],[Ut,/_/g,"."]]]},Qt=function(){function t(t,e){var n,i;this.ua=t||(null!==(i=null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)&&void 0!==i?i:""),this.rgxmap=Kt}return t.prototype.getDevice=function(){var t={vendor:void 0,model:void 0,type:void 0};return zt.rgx.call(t,this.ua,this.rgxmap.device),t},t.prototype.getEngine=function(){var t={name:void 0,version:void 0};return zt.rgx.call(t,this.ua,this.rgxmap.engine),t},t.prototype.getOS=function(){var t={name:void 0,version:void 0};return zt.rgx.call(t,this.ua,this.rgxmap.os),t},t.prototype.getResult=function(){return{engine:this.getEngine(),os:this.getOS(),device:this.getDevice()}},t}(),$t=function(){if(!document.body)return 0;var t=document.createElement("div");t.style.height="1in",t.style.width="1in",t.style.top="-100%",t.style.left="-100%",t.style.position="absolute",document.body.appendChild(t);var e=t.offsetHeight;return document.body.removeChild(t),e},Xt=["dt_omgid"],Yt=function(){function t(t){void 0===t&&(t={}),this.clientInfo=new Qt(navigator.userAgent).getResult(),this.init();var e=function(t){void 0===t&&(t={});var e=n({qq:/qq\/([\d.]+)/i,wx:/MicroMessenger\/([\w.]+)/i,qqvideo:/QQLive(?:HD)?Browser\/([\d.]+)/,qqnews:/qqnews\/(\d+\.\d+\.\d+)/i,qqreading:/qnreading\/(\d+\.\d+\.\d+)/i,qqbrowser:/MQQBrowser\/(\d+\.\d+)/i,qzone:/Qzone\/[\w\d_]*(\d\.\d)[.\w\d_]*/i,kuaibao:/qnreading\/(\d+\.\d+\.\d+)/i,weibo:/Weibo/i},t),i="",o="";return{scenePlat:Object.keys(e).some((function(t){i=t;var n=navigator.userAgent.match(e[t]);return n&&2===n.length&&(o=n[1]),n}))?i:"",sceneVersion:o}}(t.scenePlat);this.set(n(n({},t.publicParams),{web_version:t.version||"",scenes_plat:e.scenePlat,scenes_version:e.sceneVersion}),"publicParams").set(t.accountInfo||W,"accountInfo")}return t.prototype.init=function(){var t,e,n,i,o,r,a=this.clientInfo,s=a.os,l=a.device,u=a.engine;this.publicParams={platform:(r=this.clientInfo,void 0===r.device.type?"pc":r.device.type),hardware_os:(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())||"",os_version:s.version||"",target_sdk:parseInt(s.version,10)||0,resolution:window.screen.width*window.devicePixelRatio,dpi:$t(),brand:(null===(e=l.vendor)||void 0===e?void 0:e.toLowerCase())||"",mf:(null===(n=l.vendor)||void 0===n?void 0:n.toLowerCase())||"",model:(null===(i=l.model)||void 0===i?void 0:i.toLowerCase())||"",web_version:"",web_core_type:(null===(o=u.name)||void 0===o?void 0:o.toLowerCase())||"",web_core_version:u.version||"",web_channel:J("web_channel")||"",scenes_plat:"",network_type:navigator.connection?navigator.connection.effectiveType:"unknown",dt_sdkversion_h5:"3.5.3",dt_omgid:ot("video_omgid")||"",dt_omgbzid:"",dt_sessionid_h5:(new Date).getTime()+Math.random().toString().slice(2,5)}},t.prototype.get=function(t){return t?this.publicParams[t]:this.publicParams},t.prototype.set=function(e,n){var i=this;void 0===e&&(e={}),void 0===n&&(n="publicParams");var o=t.checkRules[n];if(o)return Object.keys(e).filter((function(t){return o(t)})).forEach((function(t){i.publicParams[t]=e[t]})),this},t.prototype.remove=function(e){var n=this;void 0===e&&(e="");var i=t.checkRules.publicParams;(Array.isArray(e)?e:[e]).forEach((function(t){i(t,'[universalReport] "'+t+'" cannot be deleted')&&delete n.publicParams[t]}))},t.prototype.getPublicPageParams=function(t){var e,n,i,o;return{url:window.location.href,ref_url:document.referrer,dt_pgid:null!==(e=t.pgid)&&void 0!==e?e:"",dt_ref_pgid:null!==(i=null===(n=t.ref_pg)||void 0===n?void 0:n.pgid)&&void 0!==i?i:"",dt_pgstp:null!==(o=t.pg_stp)&&void 0!==o?o:1}},t.checkRules=((Rt={}).publicParams=function(t,e){var n=-1!==String(t).indexOf("dt_")&&Xt.indexOf(t)<0;return!n},Rt.accountInfo=function(t){return Object.keys(W).includes(t)},Rt),t}(),Zt=function(){function t(){this.privateParams={}}return t.prototype.set=function(t,e,n){return void 0===e&&(e=""),void 0===n&&(n=[]),t&&n.length?(this.privateParams[t]={value:e,events:n},this):this},t.prototype.get=function(t){return t?this.privateParams[t]:this.privateParams},t.prototype.remove=function(t){t&&delete this.privateParams[t]},t.prototype.getEventPrivateParams=function(t){return Object.entries(this.privateParams).filter((function(e){return e[1].events.includes(t)})).reduce((function(t,e){var n;return Object.assign(t,((n={})[e[0]]=e[1].value,n))}),{})},t}(),te=(Tt=new Promise((function(t,e){if(navigator.userAgent.match(/TADChid/i)||!navigator.userAgent.match(/QQLiveBrowser\/([\d.]+)/))return e();var n=setTimeout((function(){e()}),500);window.TenvideoJSBridge?(clearTimeout(n),t()):document.addEventListener("onTenvideoJSBridgeReady",(function(){clearTimeout(n),t()}),!1)})),Ot=!1,Ct=null,xt=[],At=function(){for(var t=null;t=xt.shift();)t(Ct);Ot=!0},Tt.then((function(){return r(void 0,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){if(!window.TenvideoJSBridge)return t(null);window.TenvideoJSBridge.invoke("getDeviceInfo",null,(function(e){var n,i="";try{i=JSON.parse(e)}catch(t){}i.result||t(null),t({os_vrsn:null!==(n=i.result.systemVersion)&&void 0!==n?n:""})}))}))];case 1:return Ct=t.sent(),At(),[2]}}))}))})).catch((function(){At()})),function(t,e,i){return n(n({},i),{value:function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=i.value;Ot?o.apply(this,e):xt.push((function(n){o.apply(t,s(e,[n]))}))}})}),ee=function(){function t(t,e){this.options=t,this.channel=new ct(n(n({},this.options),{channel:"boss"})),this.init(e)}return t.prototype.init=function(t,e){void 0===e&&(e={}),this.convertPublicParams(t,n(n({},e),this.options.publicParams))},t.prototype.report=function(t){var e=this.convertContext(t);this.channel.report(e)},t.prototype.convertContext=function(t){var e,i,o=t.publicParams,r=this.publicParams,a=null!==(e=t.pageParams)&&void 0!==e?e:{},s=null!==(i=t.businessParams)&&void 0!==i?i:{};return r=n(n({},r),{url:o.url,ref_url:o.ref_url,ei:t.eventName.replace("dt_",""),ctime:t.eventTime,eventid:o.dt_eventid_h5}),!this.options.formatMode&&s.element_params&&(s=s.element_params.reduce((function(t,e){return n(n({},e),t)}),{})),a=F(a,M.concat(["pg_stp"])),r=F(r,M),s=F(s,M),n(n({},t),{publicParams:r,pageParams:a,businessParams:s})},t.prototype.convertPublicParams=function(t,e){var i=["android","ios"].indexOf(t.hardware_os)+1;this.publicParams=n({os:i||"",os_vrsn:i?t.os_version:"",jlbrk:"",network_type:["wifi","2g","3g","4g"].indexOf(t.network_type)+1||5,pt:this.transformPlatform(t.platform,t.hardware_os),qq:t.dt_qq_h5,qq_openid:t.dt_qqopenid_h5,wx_openid:t.dt_wxopenid_h5,wx_commid:"",omgid:t.dt_omgid||ot("video_omgid")||"",omgbizid:"",vuserid:"qq"===ot("main_login")?ot("vqq_vuserid")||ot("vuserid")||"":ot("vuserid")||"",guid:ot("guid")||ot("video_guid")||"",uuid:ot("txv_boss_uuid")||"",main_login:["wx","qq"].indexOf(t.dt_mainlogin_h5)+1,ptag:J("ptag")||"",sharesource:J("sharesource")||J("shareSource")||"",second_share:J("second_share")||"",bucket_id:ot("plat_bucketid")||"",h5_ver:t.web_version,lm_experiment_id:"",sessionid:t.dt_sessionid_h5},e)},t.prototype.transformPlatform=function(t,e){var n=0;return"phone"===t?"android"===e?n=8:"ios"===e&&(n=7):"tablet"===t&&("android"===e?n=6:"ios"===e&&(n=5)),"android"===e&&0===n&&(n=8),n},o([te],t.prototype,"init",null),o([te],t.prototype,"report",null),t}();function ne(t){var e=t;e.options.videoReport&&(e.videoReport=new ee(e.options,e.getPublicParams()))}var ie=new Promise((function(t){"undefined"!=typeof document&&"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){t()})):t()})),oe=function(t){var e=[],i=!1;return t.then((function(){var t;for(i=!0;t=e.shift();)null==t||t()})),function(t,o,r){return n(n({},r),{value:function(){for(var t=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=r.value;return i?a.apply(this,n):(e.push((function(){a.apply(t,n)})),this)}})}}(ie),re=function(t){function r(e){var i=t.call(this)||this;return i.options=e,i.videoReport=null,i.deviceId="",i.monitoringReportId="",i.monitoringReport=!1,i.monitoringJsApiReport=!1,i.enableBeaconReportRetry=!1,i.isEnablePlugin=!1,i.attaPublicParams={},i.firstPVReportMap={},i.eventsConfig={},i.isRealTimeDebug=!1,i.eventId=0,i.init(),i.checkBrowserEnvironment()?(i.monitoringReportId=e.monitoringReportId,i.monitoringReport=e.monitoringReport,i.monitoringJsApiReport=e.monitoringJsApiReport,i.monitoringReport&&ht({step:4,monitoring_id:i.monitoringReportId,monitoring_report_id:i.monitoringReportId}),i.setEventHandler(),function(){var t;null===(t=null===document||void 0===document?void 0:document.body)||void 0===t||t.hasAttribute("_eid")}(),i.initPlugin().initObserver(),i.options.isDisableInitPage||i.initPage(),i.onPageAttrChange().onChannelReport().addPageVisibilityChangeListener(),i.monitoringReport&&(i.bindSdkMonitoringEvent(),ht(n({step:5},i.attaPublicParams))),i.monitoringJsApiReport&&i.bindJsApiMonitoringEvent(),e.enableSPAMode&&i.addHistoryProxy(),i):i}return e(r,t),r.prototype.init=function(){this.publicParams=new Yt(this.options),this.attaPublicParams=this.getAttaReportPublicParams(),this.privateParams=new Zt,this.pageManager=new Nt;var t=[this.publicParams.get("scenes_plat"),this.publicParams.get("scenes_version"),this.publicParams.get("hardware_os")];return this.channel=new(ct.bind.apply(ct,s([void 0,this.options],t))),this.extraChannel=this.options.extraDefaultChannel&&this.getExtraChannel(t),this.use(ne),this.monitoringReport&&ht(n({step:1},this.attaPublicParams)),this},r.prototype.getExtraChannel=function(t){return"function"==typeof this.options.channel||"object"==typeof this.options.channel?new(ct.bind.apply(ct,s([void 0,Object.assign(this.options,{channel:this.options.extraDefaultChannel})],t))):null},r.prototype.addHistoryProxy=function(){var t=this,e=history&&"function"==typeof history.pushState&&"function"==typeof history.replaceState;e&&["pushState","replaceState"].forEach((function(e){var n=history[e];history[e]=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.switchPage(),n.apply(history,e)}})),window.addEventListener(e?"popstate":"hashchange",(function(){t.switchPage()}))},r.prototype.switchPage=function(t){var e,n,i;void 0===t&&(t="");var o=null===(e=this.pageManager)||void 0===e?void 0:e.fixPgid(t),r=null===(i=null===(n=this.pageManager)||void 0===n?void 0:n.getPage(o))||void 0===i?void 0:i.pageRoot;o&&r&&(this.traverseReportHide(r),this.unobserve(o))},r.prototype.bindSdkMonitoringEvent=function(){var t=this;return this.channel&&(this.channel.on("initChannel",(function(e){ht(n(n({step:0},t.attaPublicParams),e));var i=e.deviceId;t.deviceId=i,t.emit("initChannel",e)})),this.channel.on("beaconInitFail",(function(e){ht(n(n({step:2},t.attaPublicParams),e))})),this.channel.on("monitoringReport",(function(e){var o=e.publicParams,r=i(e,["publicParams"]);ht(n(n(n({step:6},t.attaPublicParams),r),{is_return:null==o?void 0:o.dt_pg_isreturn,eid:null==o?void 0:o.dt_eid,event_id:null==o?void 0:o.dt_eventid_h5,omgid:null==o?void 0:o.dt_omgid}))}))),this},r.prototype.bindJsApiMonitoringEvent=function(){var t=this;this.channel.on("jsApiReport",(function(e){ht(n(n(n({},t.attaPublicParams),e),{appkey:t.options.beacon}),dt)}))},r.prototype.getAttaReportPublicParams=function(){return{platform:this.publicParams.get("platform"),hardware_os:this.publicParams.get("hardware_os"),os_version:this.publicParams.get("os_version"),session_id:this.publicParams.get("dt_sessionid_h5"),sdk_version:this.publicParams.get("dt_sdkversion_h5"),omgid:this.publicParams.get("dt_omgid"),monitoring_id:this.monitoringReportId,monitoring_report_id:this.monitoringReportId,ua:null===navigator||void 0===navigator?void 0:navigator.userAgent,scenes_plat:this.publicParams.get("scenes_plat"),scenes_version:this.publicParams.get("scenes_version")}},r.prototype.checkBrowserEnvironment=function(){return!!navigator.cookieEnabled},r.prototype.setFirstPVFlag=function(t,e){this.firstPVReportMap[t]=e},r.prototype.initPlugin=function(){if(this.options.isDisableDtPlugin)return this;var t=J(V.REALTIME_DEBUG);if(J(V.REPORT_VIEW)===U.ENABLE_FEATURE)return this.loadDtPlugin(),this.setPluginTokenByParam(),this;var e=ot(V.REALTIME_DEBUG_ID),n=ot(V.REALTIME_APP_ID);return t===U.ENABLE_FEATURE||e&&n?(e=J(V.REALTIME_DEBUG_ID)||e,n=J(V.REALTIME_APP_ID)||n,this.dtDebugId=e,this.dtAppId=n,this.setRealTimeCookie(V.REALTIME_DEBUG_ID,e),this.setRealTimeCookie(V.REALTIME_APP_ID,n),this.isRealTimeDebug=!0,this.loadDtPlugin(),this):(this.loadDtPluginByToken(),this)},r.prototype.setPluginTokenByParam=function(){var t=Date.now()+6048e5;J(V.REPORT_VIEW_SET_TOKEN)===U.ENABLE_FEATURE&&localStorage.setItem(V.REPORT_VIEW_PLUGIN_TOKEN,""+t)},r.prototype.loadDtPluginByToken=function(){var t=localStorage.getItem(V.REPORT_VIEW_PLUGIN_TOKEN);t&&(Date.now()<parseInt(t,10)?this.loadDtPlugin():localStorage.removeItem(V.REPORT_VIEW_PLUGIN_TOKEN))},r.prototype.loadDtPlugin=function(){var t,e=this;this.isEnablePlugin=!0;var n,i,o=this.options.beacon;"string"==typeof o?this.beaconAppkey=o:"object"==typeof o&&(this.beaconAppkey=null===(t=null==o?void 0:o.baseInfo)||void 0===t?void 0:t.appkey),(n="https://vm.gtimg.cn/tencentvideo/script/universal-report-plugin-view.min.js",void 0===i&&(i=Date.now()+"-"+Math.random()),new Promise((function(t,e){if(document.getElementById(i))t(null);else{var o=document.getElementsByTagName("head")[0],r=document.createElement("script"),a=function(){r.onload=null,r.onreadystatechange=null,this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||t(null)};r.onload=a,r.onreadystatechange=a,r.onerror=function(t){r.onerror=null,o.removeChild(r),e(t)},r.src=n,r.id=i,o.appendChild(r)}}))).then((function(){e.use(window.universalReportPluginView,e.isRealTimeDebug)})).catch((function(t){}))},r.prototype.initObserver=function(){return this.options.isDisableObserver||this.use(kt,this.options.isDisableBubble),this},r.prototype.initPage=function(t){var e=this,i=t?[t]:document.querySelectorAll("[dt-pgid]");if(!i.length)return this;var o=this.options.contentidSet;return[].slice.call(i).forEach((function(t){var i,r,a=null===(i=t.getAttribute("dt-pgid"))||void 0===i?void 0:i.trim();if(a&&!e.pageManager.hasPage(a)){var s=o?o[a]:"",l=I.parse(null!==(r=t.getAttribute("dt-params"))&&void 0!==r?r:"");if(l.ref_pg){var u=I.parse(l.ref_pg);l.ref_pg=u.pgid?u:{}}if(l.ref_ele){var c=I.parse(l.ref_ele);l.ref_ele=c.eid?c:{}}s&&(l.contentid=s);var p=n({pgid:a},l);e.setPage(p,t),e.observe(a)}})),this},r.prototype.onPageAttrChange=function(){var t=this;return this.on("pageIdChange",(function(e,n){t.pageManager.removePage(n),null==t||t.observer.reportTree.detachDom(e),t.initPage(e)})),this.on("pageParamsChange",(function(e,i){var o,r=I.parse(null!==(o=e.getAttribute("dt-params"))&&void 0!==o?o:""),a=r.ref_pg,s=r.ref_ele;a&&(r.ref_pg=I.parse(a)),s&&(r.ref_ele=I.parse(s)),t.setPageParams(n({pgid:i},r))})),this},r.prototype.setEventHandler=function(){var t=this;this.pageVisibilityHandler=function(){"hidden"===document.visibilityState&&t.reportPgOut(),"visible"===document.visibilityState&&t.reportPV()}},r.prototype.addPageVisibilityChangeListener=function(){return!this.options.isDisableVisibilitychangeListener&&document.addEventListener("visibilitychange",this.pageVisibilityHandler),this},r.prototype.removePageVisibilityChangeListener=function(){return document.removeEventListener("visibilitychange",this.pageVisibilityHandler),this},r.prototype.onChannelReport=function(){var t=this;return this.channel.on("report",(function(e){t.emit("report",{type:"dt",event:e.eventName,data:Q(e),uid:e.uid,eventTime:e.eventTime})})),this},r.prototype.setPage=function(t,e){var i,o=null==t?void 0:t.pgid;if(this.pageManager.hasPage(o))return this;var r=null===(i=this.options.contentidSet)||void 0===i?void 0:i[o];return this.pageManager.addPage({pageParams:n(n({},r?{contentid:r}:null),t),pageRoot:e}),this},r.prototype.reportPV=function(t){var e,n,i,o,r=this.pageManager.fixPgid(t),a=null===(e=this.pageManager.getPage(r))||void 0===e?void 0:e.pageRoot,s=null===(n=this.observer)||void 0===n?void 0:n.getReportNode(a),l=null===(i=null==s?void 0:s.data)||void 0===i?void 0:i.pgIgnore,u=null===(o=null==s?void 0:s.data)||void 0===o?void 0:o.pginIgnore,c=null==s?void 0:s.uid;if(!r||!s||l||u)return this;s.updateNode(),this.pageManager.updatePage(r);var p=this.pageManager.getPage(r).pageParams,d=p.contentid,h=p.last_contentid;if(d){var f=0;h===d?f=1:this.pageManager.setPage({pageParams:{pgid:r,last_contentid:d}}),this.privateParams.set("dt_pg_isreturn",f,[q.PGIN])}else this.privateParams.remove("dt_pg_isreturn");return this.reportEvent({pgid:r,uid:c,eventName:q.PGIN,eventTime:Date.now()}),this},r.prototype.reportPgOut=function(t,e,n){var i,o,r,a,s,l;void 0===n&&(n={});var u=this.pageManager.fixPgid(t),c=this.pageManager.getPage(u),p=null===(i=this.observer)||void 0===i?void 0:i.getReportNode(null==c?void 0:c.pageRoot),d=null===(o=null==p?void 0:p.data)||void 0===o?void 0:o.pgIgnore,h=null===(r=null==p?void 0:p.data)||void 0===r?void 0:r.pgoutIgnore,f=null==p?void 0:p.uid;if(!u||!c||!p||d||h)return this;var v=null!==(a=null==n?void 0:n.area)&&void 0!==a?a:p.effectiveWidth*p.effectiveHeight,g=null!==(s=null==n?void 0:n.impArea)&&void 0!==s?s:p.maxIntersectArea,m=v?Math.min(g/v,1):0,y={dt_pg_area:v.toFixed(2),dt_pg_imp_area:g.toFixed(2),dt_lvtm:c.showTime?Date.now()-c.showTime:0,dt_clck_flag:null!==(l=c.clckFlag)&&void 0!==l?l:"0",dt_pg_imp_rate:m.toFixed(2)};return this.reportEvent({pgid:u,uid:f,eventName:q.PGOUT,eventTime:Date.now(),publicParams:y,pageParams:X(y),isSendBeacon:e}),this},r.prototype.traverseReport=function(t,e){var n,i=this,o=G(t),r=null===(n=this.observer)||void 0===n?void 0:n.getReportNode(o);r&&_t([r],e,(function(t){var n;null===(n=null==i?void 0:i.eventsConfig[e])||void 0===n||n.action.apply(t)}))},r.prototype.traverseReportHide=function(t){this.traverseReport(t,"hide")},r.prototype.traverseReportExpose=function(t){this.traverseReport(t,"expose")},r.prototype.reportElement=function(t,e){var i,o,r,a=G(t),s=null===(i=null==e?void 0:e.businessParams)||void 0===i?void 0:i.eid;if(!s||!a)return this;var l=this.pageManager.fixPgid(null==e?void 0:e.pgid),u=null==e?void 0:e.eventName,c=this.pageManager.hasPage(l),p=[q.IMP,q.IMPEND,q.CLCK].includes(u),d={};if(!c||!p)return this;var h=null===(o=this.observer)||void 0===o?void 0:o.getClosestParentNode(a),f=$(h,this.options.formatMode,n({},e.businessParams));u===q.CLCK?this.pageManager.getPage(l).clckFlag="1":u===q.IMP?a.showTime=Date.now():d=function(t){if(!t)return{};var e=t.scrollWidth*t.scrollHeight,n=(t.scrollLeft+t.clientWidth)*(t.scrollTop+t.clientHeight),i=e?Math.min(n/e,1):0,o=t.showTime;return{dt_element_area:e.toFixed(2),dt_ele_imp_area:n.toFixed(2),dt_element_lvtm:o?Date.now()-o:0,dt_ele_imp_rate:i.toFixed(2)}}(a);var v=null===(r=this.observer)||void 0===r?void 0:r.getReportNode(a),g=null==v?void 0:v.uid;return this.reportEvent(n(n({pgid:l,uid:g,eventTime:Date.now()},e),{publicParams:n(n({dt_eid:s},d),e.publicParams),businessParams:n(n({},X(d)),f)})),this},r.prototype.reportEvent=function(t){var e,n,i,o,r;void 0===t&&(t={});var a=t;this.monitoringReport&&Object.assign(a,{monitoringReport:!0}),this.monitoringJsApiReport&&Object.assign(a,{monitoringJsApiReport:!0});var s=null==a?void 0:a.eventName;if(!s)return this;var l=null==a?void 0:a.uid;a.eventTime=(null==a?void 0:a.eventTime)||Date.now(),a.publicParams=null!==(e=a.publicParams)&&void 0!==e?e:{},a.publicParams.dt_eventid_h5=this.eventId,this.isRealTimeDebug&&Object.assign(a.publicParams,{dt_debugid:this.dtDebugId,dt_uid:l,dt_appid:this.dtAppId}),this.eventId+=1,s===q.PGOUT&&"app"!==(null===(i=null===(n=this.channel)||void 0===n?void 0:n.curChannel)||void 0===i?void 0:i.type)&&(a.isSendBeacon=!0);var u=this.formatContext(a);return this.channel.report(u),null===(o=this.extraChannel)||void 0===o||o.report(u),null===(r=this.videoReport)||void 0===r||r.report(u),this},r.prototype.reportBeaconEvent=function(t){return void 0===t&&(t={}),Object.assign(t,{isSendBeacon:!0}),this.reportEvent(t)},r.prototype.observe=function(t){var e,n,i=this.pageManager.fixPgid(t),o=null===(e=this.pageManager.getPage(i))||void 0===e?void 0:e.pageRoot;return i&&o?(o.hasAttribute("dt-pgid")||o.setAttribute("dt-pgid",i),null===(n=this.observer)||void 0===n||n.reportTree.attachDom(o),this.firstPVReportMap[i]||"true"===o.getAttribute("dt-pg-ignore")||"true"===o.getAttribute("dt-pgin-ignore")||"hold=true"===o.getAttribute("dt-cmd")||(this.setFirstPVFlag(i,"first_reported"),this.reportPV(i)),this):this},r.prototype.unobserve=function(t){var e,n,i,o=null===(e=this.pageManager)||void 0===e?void 0:e.fixPgid(t),r=null===(i=null===(n=this.pageManager)||void 0===n?void 0:n.getPage(o))||void 0===i?void 0:i.pageRoot;return o&&r?(this.options.enableSPAMode||r.removeAttribute("dt-pgid"),this.pageManager.removePage(o),null==this||this.observer.reportTree.detachDom(r),this.firstPVReportMap[o]=null,this):this},r.prototype.formatContext=function(t){var e,i=this.pageManager.fixPgid(null==t?void 0:t.pgid),o=null==t?void 0:t.eventName,r=null===(e=null==t?void 0:t.businessParams)||void 0===e?void 0:e.eid,a=this.getPageParams(i),s=this.getPublicParams(),l=this.privateParams.getEventPrivateParams(o),u=this.publicParams.getPublicPageParams(a),c=F(n(n(n(n(n(n({},r?{dt_eid:r}:null),s),l),u),{dt_pgid:i}),t.publicParams),M),p=F(n(n({},a),t.pageParams),M),d=F(t.businessParams||{},M);return n(n({},t),{eventName:o,pgid:i,publicParams:c,pageParams:p,businessParams:d})},r.prototype.getReportParams=function(t,e){var i;void 0===e&&(e=this.options.formatMode);var o=G(t);if(!o)return"";var r=null===(i=this.observer)||void 0===i?void 0:i.getReportNode(o);if(!r)return"";var a=It(r,"pgid"),s=r.data.eid;if(!a||!s)return"";var l=$(r,e,n({eid:s},r.data.params)),u=this.formatContext({pgid:a,businessParams:l});return Q(u).udf_kv},r.prototype.setPageParams=function(t){var e;return null===(e=this.pageManager)||void 0===e||e.setPage({pageParams:t}),this},r.prototype.getPageParams=function(t,e){var n,i,o,r=this.pageManager.fixPgid(t);if(!r)return{};var a=null!==(i=null===(n=this.pageManager.getPage(r))||void 0===n?void 0:n.pageParams)&&void 0!==i?i:{};return e?null!==(o=a[e])&&void 0!==o?o:"":a},r.prototype.getPublicParams=function(t){return this.publicParams.get(t)},r.prototype.setPublicParams=function(t,e){var n;return void 0===t&&(t={}),void 0===e&&(e="publicParams"),this.publicParams.set(t,e),null===(n=this.videoReport)||void 0===n||n.convertPublicParams(this.getPublicParams(),"publicParams"===e?t:{}),this},r.prototype.removePublicParams=function(t){return void 0===t&&(t=""),this.publicParams.remove(t),this},r.prototype.setAccountInfo=function(t){return this.setPublicParams(t,"accountInfo"),this},r.prototype.clearAccountInfo=function(){return this.setPublicParams(W,"accountInfo"),this},r.prototype.setCommand=function(t,e){var i,o=G(t);if(!o||!e)return this;var r=I.parse(null!==(i=o.getAttribute("dt-cmd"))&&void 0!==i?i:"");o.setAttribute("dt-cmd",I.stringify(n(n({},r),e)))},r.prototype.setPageContentId=function(t){if(t)return this.privateParams.set("dt_pg_contentid",t,[q.PGIN,q.PGOUT,q.IMP,q.IMPEND,q.CLCK]),this},r.prototype.setMultiPageContentids=function(t){var e=this;if(t)return Object.keys(t).forEach((function(n){if(e.pageManager.hasPage(n)){var i=t[n];e.pageManager.setPage({pageParams:{pgid:n,contentid:i}})}})),this},r.prototype.setRealTimeCookie=function(t,e,n,i){it(t,e,null!=n?n:""+new Date(Date.now()+18e5).toUTCString(),(null!=i?i:location.hostname.indexOf(j)>-1)?j:location.hostname)},o([oe],r.prototype,"initObserver",null),o([oe],r.prototype,"initPage",null),o([oe],r.prototype,"reportPV",null),o([oe],r.prototype,"reportEvent",null),o([oe],r.prototype,"reportBeaconEvent",null),o([oe],r.prototype,"observe",null),o([oe],r.prototype,"unobserve",null),r}(O);return re}));
export function hi() {
  alert(`Hello`);
}
